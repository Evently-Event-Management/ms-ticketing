{"timestamp":"2025-10-07T11:27:50.933Z","level":"INFO","category":"LOGGER","message":"Enhanced logging system initialized","file":"logger.go","line":68}
{"timestamp":"2025-10-07T11:27:50.933Z","level":"INFO","category":"LOGGER","message":"Log file: logs/order-gateway-2025-10-07.log","file":"logger.go","line":69}
{"timestamp":"2025-10-07T11:27:50.933Z","level":"INFO","category":"APP","message":"Starting Order Service initialization","file":"main.go","line":185}
{"timestamp":"2025-10-07T11:27:50.933Z","level":"INFO","category":"CONFIG","message":"Loaded environment variables from .env file","file":"main.go","line":191}
{"timestamp":"2025-10-07T11:27:50.933Z","level":"INFO","category":"APP","message":"Verifying database connections","file":"main.go","line":199}
{"timestamp":"2025-10-07T11:27:50.933Z","level":"INFO","category":"DATABASE","message":"Attempting to connect to PostgreSQL (attempt 1/5)","file":"main.go","line":121}
{"timestamp":"2025-10-07T11:27:50.939Z","level":"INFO","category":"DATABASE","message":"âœ… PostgreSQL connection successful","file":"main.go","line":145}
{"timestamp":"2025-10-07T11:27:50.940Z","level":"INFO","category":"REDIS","message":"Keyspace notifications enabled for expired events","file":"main.go","line":166}
{"timestamp":"2025-10-07T11:27:50.940Z","level":"INFO","category":"DATABASE","message":"âœ… Redis connection successful to localhost:6379 (DB: 0)","file":"main.go","line":168}
{"timestamp":"2025-10-07T11:27:50.940Z","level":"INFO","category":"KAFKA","message":"Initializing Kafka producer","file":"main.go","line":211}
{"timestamp":"2025-10-07T11:27:50.940Z","level":"INFO","category":"KAFKA","message":"Using Kafka address from environment variable: localhost:9092","file":"main.go","line":214}
{"timestamp":"2025-10-07T11:27:50.941Z","level":"INFO","category":"KAFKA","message":"Kafka brokers configured: [localhost:9092]","file":"main.go","line":216}
{"timestamp":"2025-10-07T11:27:50.941Z","level":"INFO","category":"KAFKA","message":"Kafka producer initialized successfully","file":"main.go","line":218}
{"timestamp":"2025-10-07T11:27:50.941Z","level":"INFO","category":"KAFKA","message":"Ensuring required topics exist","file":"main.go","line":221}
{"timestamp":"2025-10-07T11:27:51.979Z","level":"INFO","category":"KAFKA","message":"Required topics ensured successfully","file":"main.go","line":234}
{"timestamp":"2025-10-07T11:27:51.979Z","level":"INFO","category":"SERVICE","message":"Initializing ticket service","file":"main.go","line":237}
{"timestamp":"2025-10-07T11:27:51.979Z","level":"INFO","category":"SERVICE","message":"Initializing order service","file":"main.go","line":240}
{"timestamp":"2025-10-07T11:27:51.979Z","level":"INFO","category":"LOGGER","message":"Enhanced logging system initialized","file":"logger.go","line":68}
{"timestamp":"2025-10-07T11:27:51.979Z","level":"INFO","category":"LOGGER","message":"Log file: logs/order-gateway-2025-10-07.log","file":"logger.go","line":69}
{"timestamp":"2025-10-07T11:27:51.979Z","level":"INFO","category":"LOGGER","message":"Enhanced logging system initialized","file":"logger.go","line":68}
{"timestamp":"2025-10-07T11:27:51.979Z","level":"INFO","category":"LOGGER","message":"Log file: logs/order-gateway-2025-10-07.log","file":"logger.go","line":69}
{"timestamp":"2025-10-07T11:27:51.979Z","level":"INFO","category":"HTTP","message":"Setting up router and middleware","file":"main.go","line":259}
{"timestamp":"2025-10-07T11:27:52.021Z","level":"INFO","category":"AUTH","message":"JWT middleware applied globally","file":"main.go","line":265}
{"timestamp":"2025-10-07T11:27:52.021Z","level":"INFO","category":"ROUTER","message":"Order routes registered under /api/order","file":"main.go","line":279}
{"timestamp":"2025-10-07T11:27:52.021Z","level":"INFO","category":"ROUTER","message":"Ticket routes registered under /api/order/ticket","file":"main.go","line":289}
{"timestamp":"2025-10-07T11:27:52.021Z","level":"INFO","category":"REDIS","message":"Starting seat unlock subscription","file":"main.go","line":299}
{"timestamp":"2025-10-07T11:27:52.022Z","level":"INFO","category":"REDIS","message":"Current keyspace notifications setting: [notify-keyspace-events xE]","file":"main.go","line":48}
{"timestamp":"2025-10-07T11:27:52.023Z","level":"INFO","category":"REDIS","message":"Subscribed to Redis keyevent expired notifications (DB 0)","file":"main.go","line":55}
{"timestamp":"2025-10-07T11:27:52.023Z","level":"INFO","category":"HTTP","message":"ðŸš€ Order Service running on :8084","file":"main.go","line":304}
{"timestamp":"2025-10-07T11:27:52.023Z","level":"INFO","category":"APP","message":"Service started successfully, waiting for shutdown signal","file":"main.go","line":313}
{"timestamp":"2025-10-07T11:29:42.629Z","level":"INFO","category":"API","message":"SeatValidationAndPlaceOrder: received request","file":"handler.go","line":254}
{"timestamp":"2025-10-07T11:29:42.630Z","level":"DEBUG","category":"API","message":"SeatValidationAndPlaceOrder: SessionID: 0e16aca6-92dd-4847-b952-31552963c335","file":"handler.go","line":265}
{"timestamp":"2025-10-07T11:29:42.630Z","level":"DEBUG","category":"API","message":"SeatValidationAndPlaceOrder: SeatIDs: [d74d785c-2ff4-4fe8-aad0-c2262e8cddd3 7217b0d5-8c75-47b0-8734-e1bc7f6ef476]","file":"handler.go","line":266}
{"timestamp":"2025-10-07T11:29:42.630Z","level":"INFO","category":"ORDER","message":"Starting seat validation and order placement process","file":"service.go","line":210}
{"timestamp":"2025-10-07T11:29:42.630Z","level":"DEBUG","category":"ORDER","message":"Order request: {SessionID:0e16aca6-92dd-4847-b952-31552963c335 EventID:79955f7b-3735-4dce-a112-ba0ef29d36bd SeatIDs:[d74d785c-2ff4-4fe8-aad0-c2262e8cddd3 7217b0d5-8c75-47b0-8734-e1bc7f6ef476] DiscountID:6e52d131-9994-49d2-86e2-99b16c2178d4}","file":"service.go","line":225}
{"timestamp":"2025-10-07T11:29:42.630Z","level":"DEBUG","category":"AUTH","message":"Requesting M2M token for seat validation","file":"service.go","line":233}
{"timestamp":"2025-10-07T11:29:42.660Z","level":"DEBUG","category":"ORDER","message":"Generated order ID: f0abb7fb-a65d-49d2-b2dd-d59bb4fb76f5","file":"service.go","line":242}
{"timestamp":"2025-10-07T11:29:42.660Z","level":"DEBUG","category":"PRE_VALIDATION","message":"Making first HTTP request to validate pre-order","file":"service.go","line":245}
{"timestamp":"2025-10-07T11:29:42.660Z","level":"DEBUG","category":"PRE_VALIDATION","message":"Pre-validation URL: http://localhost:8082/api/event-query/internal/v1/validate-pre-order","file":"service.go","line":260}
{"timestamp":"2025-10-07T11:29:42.660Z","level":"DEBUG","category":"PRE_VALIDATION","message":"Request body: {\"session_id\":\"0e16aca6-92dd-4847-b952-31552963c335\",\"event_id\":\"79955f7b-3735-4dce-a112-ba0ef29d36bd\",\"seat_ids\":[\"d74d785c-2ff4-4fe8-aad0-c2262e8cddd3\",\"7217b0d5-8c75-47b0-8734-e1bc7f6ef476\"],\"discount_id\":\"6e52d131-9994-49d2-86e2-99b16c2178d4\"}","file":"service.go","line":261}
{"timestamp":"2025-10-07T11:29:42.693Z","level":"INFO","category":"PRE_VALIDATION","message":"Pre-validation successful, OrderDetailsDTO received","file":"service.go","line":291}
{"timestamp":"2025-10-07T11:29:42.693Z","level":"DEBUG","category":"REDIS","message":"Attempting to lock seats in Redis","file":"service.go","line":294}
{"timestamp":"2025-10-07T11:29:45.717Z","level":"INFO","category":"REDIS","message":"Seats locked successfully","file":"service.go","line":304}
{"timestamp":"2025-10-07T11:29:45.717Z","level":"DEBUG","category":"SEAT_VALIDATION","message":"Making second HTTP request to validate seats after locking","file":"service.go","line":313}
{"timestamp":"2025-10-07T11:29:46.251Z","level":"INFO","category":"SEAT_VALIDATION","message":"Final seat validation successful","file":"service.go","line":349}
{"timestamp":"2025-10-07T11:29:47.262Z","level":"INFO","category":"KAFKA","message":"Published seats locked event for 2 seats","file":"service.go","line":533}
{"timestamp":"2025-10-07T11:29:47.262Z","level":"DEBUG","category":"DISCOUNT","message":"Processing discount from OrderDetailsDTO: SAVE10","file":"service.go","line":370}
{"timestamp":"2025-10-07T11:29:47.262Z","level":"INFO","category":"DISCOUNT","message":"Applied discount: 180.00, final price: 1620.00","file":"service.go","line":401}
{"timestamp":"2025-10-07T11:29:47.262Z","level":"INFO","category":"ORDER","message":"Placing order: f0abb7fb-a65d-49d2-b2dd-d59bb4fb76f5 for session: 0e16aca6-92dd-4847-b952-31552963c335","file":"service.go","line":72}
{"timestamp":"2025-10-07T11:29:47.263Z","level":"DEBUG","category":"ORDER","message":"Locking seats...","file":"service.go","line":75}
{"timestamp":"2025-10-07T11:29:47.263Z","level":"ERROR","category":"ORDER","message":"Failed to lock seats: one or more seats already locked","file":"service.go","line":82}
{"timestamp":"2025-10-07T11:29:47.263Z","level":"ERROR","category":"ORDER","message":"Failed to place order: one or more seats already locked. Unlocking seats.","file":"service.go","line":420}
{"timestamp":"2025-10-07T11:29:47.263Z","level":"WARN","category":"TXN","message":"Rolling back: unlocking seats","file":"service.go","line":308}
{"timestamp":"2025-10-07T11:29:50.275Z","level":"ERROR","category":"API","message":"SeatValidationAndPlaceOrder: seat validation failed: failed to place order: one or more seats already locked","file":"handler.go","line":271}
{"timestamp":"2025-10-07T11:31:56.221Z","level":"INFO","category":"API","message":"SeatValidationAndPlaceOrder: received request","file":"handler.go","line":254}
{"timestamp":"2025-10-07T11:31:56.222Z","level":"DEBUG","category":"API","message":"SeatValidationAndPlaceOrder: SessionID: 0e16aca6-92dd-4847-b952-31552963c335","file":"handler.go","line":265}
{"timestamp":"2025-10-07T11:31:56.222Z","level":"DEBUG","category":"API","message":"SeatValidationAndPlaceOrder: SeatIDs: [76fad3f0-e7f9-4b55-a0eb-0b7a6743ad5d]","file":"handler.go","line":266}
{"timestamp":"2025-10-07T11:31:56.222Z","level":"INFO","category":"ORDER","message":"Starting seat validation and order placement process","file":"service.go","line":210}
{"timestamp":"2025-10-07T11:31:56.222Z","level":"DEBUG","category":"ORDER","message":"Order request: {SessionID:0e16aca6-92dd-4847-b952-31552963c335 EventID:79955f7b-3735-4dce-a112-ba0ef29d36bd SeatIDs:[76fad3f0-e7f9-4b55-a0eb-0b7a6743ad5d] DiscountID:6e52d131-9994-49d2-86e2-99b16c2178d4}","file":"service.go","line":225}
{"timestamp":"2025-10-07T11:31:56.222Z","level":"DEBUG","category":"AUTH","message":"Requesting M2M token for seat validation","file":"service.go","line":233}
{"timestamp":"2025-10-07T11:31:56.231Z","level":"DEBUG","category":"ORDER","message":"Generated order ID: e6de7f63-7d70-4cde-a010-10455974a0a3","file":"service.go","line":242}
{"timestamp":"2025-10-07T11:31:56.232Z","level":"DEBUG","category":"PRE_VALIDATION","message":"Making first HTTP request to validate pre-order","file":"service.go","line":245}
{"timestamp":"2025-10-07T11:31:56.232Z","level":"DEBUG","category":"PRE_VALIDATION","message":"Pre-validation URL: http://localhost:8082/api/event-query/internal/v1/validate-pre-order","file":"service.go","line":260}
{"timestamp":"2025-10-07T11:31:56.232Z","level":"DEBUG","category":"PRE_VALIDATION","message":"Request body: {\"session_id\":\"0e16aca6-92dd-4847-b952-31552963c335\",\"event_id\":\"79955f7b-3735-4dce-a112-ba0ef29d36bd\",\"seat_ids\":[\"76fad3f0-e7f9-4b55-a0eb-0b7a6743ad5d\"],\"discount_id\":\"6e52d131-9994-49d2-86e2-99b16c2178d4\"}","file":"service.go","line":261}
{"timestamp":"2025-10-07T11:31:56.275Z","level":"INFO","category":"PRE_VALIDATION","message":"Pre-validation successful, OrderDetailsDTO received","file":"service.go","line":291}
{"timestamp":"2025-10-07T11:31:56.275Z","level":"DEBUG","category":"REDIS","message":"Attempting to lock seats in Redis","file":"service.go","line":294}
{"timestamp":"2025-10-07T11:31:57.277Z","level":"INFO","category":"REDIS","message":"Seats locked successfully","file":"service.go","line":304}
{"timestamp":"2025-10-07T11:31:57.277Z","level":"DEBUG","category":"SEAT_VALIDATION","message":"Making second HTTP request to validate seats after locking","file":"service.go","line":313}
{"timestamp":"2025-10-07T11:31:57.332Z","level":"INFO","category":"SEAT_VALIDATION","message":"Final seat validation successful","file":"service.go","line":349}
{"timestamp":"2025-10-07T11:31:58.334Z","level":"INFO","category":"KAFKA","message":"Published seats locked event for 1 seats","file":"service.go","line":533}
{"timestamp":"2025-10-07T11:31:58.334Z","level":"DEBUG","category":"DISCOUNT","message":"Processing discount from OrderDetailsDTO: SAVE10","file":"service.go","line":370}
{"timestamp":"2025-10-07T11:31:58.335Z","level":"INFO","category":"DISCOUNT","message":"Applied discount: 150.00, final price: 1350.00","file":"service.go","line":401}
{"timestamp":"2025-10-07T11:31:58.335Z","level":"INFO","category":"ORDER","message":"Placing order: e6de7f63-7d70-4cde-a010-10455974a0a3 for session: 0e16aca6-92dd-4847-b952-31552963c335","file":"service.go","line":72}
{"timestamp":"2025-10-07T11:31:58.335Z","level":"DEBUG","category":"ORDER","message":"Locking seats...","file":"service.go","line":75}
{"timestamp":"2025-10-07T11:31:58.335Z","level":"ERROR","category":"ORDER","message":"Failed to lock seats: one or more seats already locked","file":"service.go","line":82}
{"timestamp":"2025-10-07T11:31:58.335Z","level":"ERROR","category":"ORDER","message":"Failed to place order: one or more seats already locked. Unlocking seats.","file":"service.go","line":420}
{"timestamp":"2025-10-07T11:31:58.335Z","level":"WARN","category":"TXN","message":"Rolling back: unlocking seats","file":"service.go","line":308}
{"timestamp":"2025-10-07T11:31:59.337Z","level":"ERROR","category":"API","message":"SeatValidationAndPlaceOrder: seat validation failed: failed to place order: one or more seats already locked","file":"handler.go","line":271}
{"timestamp":"2025-10-07T11:32:15.165Z","level":"INFO","category":"API","message":"SeatValidationAndPlaceOrder: received request","file":"handler.go","line":254}
{"timestamp":"2025-10-07T11:32:15.165Z","level":"DEBUG","category":"API","message":"SeatValidationAndPlaceOrder: SessionID: 0e16aca6-92dd-4847-b952-31552963c335","file":"handler.go","line":265}
{"timestamp":"2025-10-07T11:32:15.165Z","level":"DEBUG","category":"API","message":"SeatValidationAndPlaceOrder: SeatIDs: [76fad3f0-e7f9-4b55-a0eb-0b7a6743ad5d]","file":"handler.go","line":266}
{"timestamp":"2025-10-07T11:32:15.165Z","level":"INFO","category":"ORDER","message":"Starting seat validation and order placement process","file":"service.go","line":210}
{"timestamp":"2025-10-07T11:32:15.165Z","level":"DEBUG","category":"ORDER","message":"Order request: {SessionID:0e16aca6-92dd-4847-b952-31552963c335 EventID:79955f7b-3735-4dce-a112-ba0ef29d36bd SeatIDs:[76fad3f0-e7f9-4b55-a0eb-0b7a6743ad5d] DiscountID:6e52d131-9994-49d2-86e2-99b16c2178d4}","file":"service.go","line":225}
{"timestamp":"2025-10-07T11:32:15.165Z","level":"DEBUG","category":"AUTH","message":"Requesting M2M token for seat validation","file":"service.go","line":233}
{"timestamp":"2025-10-07T11:32:15.170Z","level":"DEBUG","category":"ORDER","message":"Generated order ID: b19642cf-065c-4a84-86a9-68ab8ab05e74","file":"service.go","line":242}
{"timestamp":"2025-10-07T11:32:15.170Z","level":"DEBUG","category":"PRE_VALIDATION","message":"Making first HTTP request to validate pre-order","file":"service.go","line":245}
{"timestamp":"2025-10-07T11:32:15.170Z","level":"DEBUG","category":"PRE_VALIDATION","message":"Pre-validation URL: http://localhost:8082/api/event-query/internal/v1/validate-pre-order","file":"service.go","line":260}
{"timestamp":"2025-10-07T11:32:15.170Z","level":"DEBUG","category":"PRE_VALIDATION","message":"Request body: {\"session_id\":\"0e16aca6-92dd-4847-b952-31552963c335\",\"event_id\":\"79955f7b-3735-4dce-a112-ba0ef29d36bd\",\"seat_ids\":[\"76fad3f0-e7f9-4b55-a0eb-0b7a6743ad5d\"],\"discount_id\":\"6e52d131-9994-49d2-86e2-99b16c2178d4\"}","file":"service.go","line":261}
{"timestamp":"2025-10-07T11:32:15.185Z","level":"INFO","category":"PRE_VALIDATION","message":"Pre-validation successful, OrderDetailsDTO received","file":"service.go","line":291}
{"timestamp":"2025-10-07T11:32:15.185Z","level":"DEBUG","category":"REDIS","message":"Attempting to lock seats in Redis","file":"service.go","line":294}
{"timestamp":"2025-10-07T11:32:16.187Z","level":"INFO","category":"REDIS","message":"Seats locked successfully","file":"service.go","line":304}
{"timestamp":"2025-10-07T11:32:16.187Z","level":"DEBUG","category":"SEAT_VALIDATION","message":"Making second HTTP request to validate seats after locking","file":"service.go","line":313}
{"timestamp":"2025-10-07T11:32:16.199Z","level":"INFO","category":"SEAT_VALIDATION","message":"Final seat validation successful","file":"service.go","line":349}
{"timestamp":"2025-10-07T11:32:17.201Z","level":"INFO","category":"KAFKA","message":"Published seats locked event for 1 seats","file":"service.go","line":533}
{"timestamp":"2025-10-07T11:32:17.201Z","level":"DEBUG","category":"DISCOUNT","message":"Processing discount from OrderDetailsDTO: SAVE10","file":"service.go","line":370}
{"timestamp":"2025-10-07T11:32:17.201Z","level":"INFO","category":"DISCOUNT","message":"Applied discount: 150.00, final price: 1350.00","file":"service.go","line":401}
{"timestamp":"2025-10-07T11:32:17.201Z","level":"INFO","category":"ORDER","message":"Placing order: b19642cf-065c-4a84-86a9-68ab8ab05e74 for session: 0e16aca6-92dd-4847-b952-31552963c335","file":"service.go","line":72}
{"timestamp":"2025-10-07T11:32:17.201Z","level":"DEBUG","category":"ORDER","message":"Locking seats...","file":"service.go","line":75}
{"timestamp":"2025-10-07T11:32:17.201Z","level":"ERROR","category":"ORDER","message":"Failed to lock seats: one or more seats already locked","file":"service.go","line":82}
{"timestamp":"2025-10-07T11:32:17.201Z","level":"ERROR","category":"ORDER","message":"Failed to place order: one or more seats already locked. Unlocking seats.","file":"service.go","line":420}
{"timestamp":"2025-10-07T11:32:17.201Z","level":"WARN","category":"TXN","message":"Rolling back: unlocking seats","file":"service.go","line":308}
{"timestamp":"2025-10-07T11:32:18.203Z","level":"ERROR","category":"API","message":"SeatValidationAndPlaceOrder: seat validation failed: failed to place order: one or more seats already locked","file":"handler.go","line":271}
{"timestamp":"2025-10-07T11:34:12.945Z","level":"INFO","category":"APP","message":"Shutdown signal received, initiating graceful shutdown","file":"main.go","line":316}
{"timestamp":"2025-10-07T11:34:12.945Z","level":"INFO","category":"HTTP","message":"âœ… Order Service shutdown complete","file":"main.go","line":323}
{"timestamp":"2025-10-07T11:34:12.945Z","level":"INFO","category":"DATABASE","message":"Redis connection closed","file":"main.go","line":208}
{"timestamp":"2025-10-07T11:34:12.945Z","level":"INFO","category":"DATABASE","message":"PostgreSQL connection closed","file":"main.go","line":204}
{"timestamp":"2025-10-07T11:34:12.945Z","level":"INFO","category":"LOGGER","message":"Closing log file","file":"logger.go","line":216}
{"timestamp":"2025-10-07T11:34:15.955Z","level":"INFO","category":"LOGGER","message":"Enhanced logging system initialized","file":"logger.go","line":68}
{"timestamp":"2025-10-07T11:34:15.955Z","level":"INFO","category":"LOGGER","message":"Log file: logs/order-gateway-2025-10-07.log","file":"logger.go","line":69}
{"timestamp":"2025-10-07T11:34:15.955Z","level":"INFO","category":"APP","message":"Starting Order Service initialization","file":"main.go","line":185}
{"timestamp":"2025-10-07T11:34:15.955Z","level":"INFO","category":"CONFIG","message":"Loaded environment variables from .env file","file":"main.go","line":191}
{"timestamp":"2025-10-07T11:34:15.955Z","level":"INFO","category":"APP","message":"Verifying database connections","file":"main.go","line":199}
{"timestamp":"2025-10-07T11:34:15.955Z","level":"INFO","category":"DATABASE","message":"Attempting to connect to PostgreSQL (attempt 1/5)","file":"main.go","line":121}
{"timestamp":"2025-10-07T11:34:15.961Z","level":"INFO","category":"DATABASE","message":"âœ… PostgreSQL connection successful","file":"main.go","line":145}
{"timestamp":"2025-10-07T11:34:15.966Z","level":"INFO","category":"REDIS","message":"Keyspace notifications enabled for expired events","file":"main.go","line":166}
{"timestamp":"2025-10-07T11:34:15.966Z","level":"INFO","category":"DATABASE","message":"âœ… Redis connection successful to localhost:6379 (DB: 0)","file":"main.go","line":168}
{"timestamp":"2025-10-07T11:34:15.966Z","level":"INFO","category":"KAFKA","message":"Initializing Kafka producer","file":"main.go","line":211}
{"timestamp":"2025-10-07T11:34:15.966Z","level":"INFO","category":"KAFKA","message":"Using Kafka address from environment variable: localhost:9092","file":"main.go","line":214}
{"timestamp":"2025-10-07T11:34:15.966Z","level":"INFO","category":"KAFKA","message":"Kafka brokers configured: [localhost:9092]","file":"main.go","line":216}
{"timestamp":"2025-10-07T11:34:15.966Z","level":"INFO","category":"KAFKA","message":"Kafka producer initialized successfully","file":"main.go","line":218}
{"timestamp":"2025-10-07T11:34:15.966Z","level":"INFO","category":"KAFKA","message":"Ensuring required topics exist","file":"main.go","line":221}
{"timestamp":"2025-10-07T11:34:16.977Z","level":"INFO","category":"KAFKA","message":"Required topics ensured successfully","file":"main.go","line":234}
{"timestamp":"2025-10-07T11:34:16.977Z","level":"INFO","category":"SERVICE","message":"Initializing ticket service","file":"main.go","line":237}
{"timestamp":"2025-10-07T11:34:16.977Z","level":"INFO","category":"SERVICE","message":"Initializing order service","file":"main.go","line":240}
{"timestamp":"2025-10-07T11:34:16.977Z","level":"INFO","category":"LOGGER","message":"Enhanced logging system initialized","file":"logger.go","line":68}
{"timestamp":"2025-10-07T11:34:16.977Z","level":"INFO","category":"LOGGER","message":"Log file: logs/order-gateway-2025-10-07.log","file":"logger.go","line":69}
{"timestamp":"2025-10-07T11:34:16.977Z","level":"INFO","category":"LOGGER","message":"Enhanced logging system initialized","file":"logger.go","line":68}
{"timestamp":"2025-10-07T11:34:16.977Z","level":"INFO","category":"LOGGER","message":"Log file: logs/order-gateway-2025-10-07.log","file":"logger.go","line":69}
{"timestamp":"2025-10-07T11:34:16.977Z","level":"INFO","category":"HTTP","message":"Setting up router and middleware","file":"main.go","line":259}
{"timestamp":"2025-10-07T11:34:16.983Z","level":"INFO","category":"AUTH","message":"JWT middleware applied globally","file":"main.go","line":265}
{"timestamp":"2025-10-07T11:34:16.983Z","level":"INFO","category":"ROUTER","message":"Order routes registered under /api/order","file":"main.go","line":279}
{"timestamp":"2025-10-07T11:34:16.983Z","level":"INFO","category":"ROUTER","message":"Ticket routes registered under /api/order/ticket","file":"main.go","line":289}
{"timestamp":"2025-10-07T11:34:16.983Z","level":"INFO","category":"REDIS","message":"Starting seat unlock subscription","file":"main.go","line":299}
{"timestamp":"2025-10-07T11:34:16.983Z","level":"INFO","category":"REDIS","message":"Current keyspace notifications setting: [notify-keyspace-events xE]","file":"main.go","line":48}
{"timestamp":"2025-10-07T11:34:16.984Z","level":"INFO","category":"REDIS","message":"Subscribed to Redis keyevent expired notifications (DB 0)","file":"main.go","line":55}
{"timestamp":"2025-10-07T11:34:16.984Z","level":"INFO","category":"HTTP","message":"ðŸš€ Order Service running on :8084","file":"main.go","line":304}
{"timestamp":"2025-10-07T11:34:16.984Z","level":"INFO","category":"APP","message":"Service started successfully, waiting for shutdown signal","file":"main.go","line":313}
{"timestamp":"2025-10-07T11:37:56.468Z","level":"INFO","category":"API","message":"SeatValidationAndPlaceOrder: received request","file":"handler.go","line":254}
{"timestamp":"2025-10-07T11:37:56.468Z","level":"DEBUG","category":"API","message":"SeatValidationAndPlaceOrder: SessionID: 0e16aca6-92dd-4847-b952-31552963c335","file":"handler.go","line":265}
{"timestamp":"2025-10-07T11:37:56.468Z","level":"DEBUG","category":"API","message":"SeatValidationAndPlaceOrder: SeatIDs: [76fad3f0-e7f9-4b55-a0eb-0b7a6743ad5d]","file":"handler.go","line":266}
{"timestamp":"2025-10-07T11:37:56.468Z","level":"INFO","category":"ORDER","message":"Starting seat validation and order placement process","file":"service.go","line":210}
{"timestamp":"2025-10-07T11:37:56.469Z","level":"DEBUG","category":"ORDER","message":"Order request: {SessionID:0e16aca6-92dd-4847-b952-31552963c335 EventID:79955f7b-3735-4dce-a112-ba0ef29d36bd SeatIDs:[76fad3f0-e7f9-4b55-a0eb-0b7a6743ad5d] DiscountID:6e52d131-9994-49d2-86e2-99b16c2178d4}","file":"service.go","line":225}
{"timestamp":"2025-10-07T11:37:56.469Z","level":"DEBUG","category":"AUTH","message":"Requesting M2M token for seat validation","file":"service.go","line":233}
{"timestamp":"2025-10-07T11:37:56.480Z","level":"DEBUG","category":"ORDER","message":"Generated order ID: 875c83fa-a21f-4ad9-981c-d078f6767e44","file":"service.go","line":242}
{"timestamp":"2025-10-07T11:37:56.480Z","level":"DEBUG","category":"PRE_VALIDATION","message":"Making first HTTP request to validate pre-order","file":"service.go","line":245}
{"timestamp":"2025-10-07T11:37:56.480Z","level":"DEBUG","category":"PRE_VALIDATION","message":"Pre-validation URL: http://localhost:8082/api/event-query/internal/v1/validate-pre-order","file":"service.go","line":260}
{"timestamp":"2025-10-07T11:37:56.480Z","level":"DEBUG","category":"PRE_VALIDATION","message":"Request body: {\"session_id\":\"0e16aca6-92dd-4847-b952-31552963c335\",\"event_id\":\"79955f7b-3735-4dce-a112-ba0ef29d36bd\",\"seat_ids\":[\"76fad3f0-e7f9-4b55-a0eb-0b7a6743ad5d\"],\"discount_id\":\"6e52d131-9994-49d2-86e2-99b16c2178d4\"}","file":"service.go","line":261}
{"timestamp":"2025-10-07T11:37:57.362Z","level":"INFO","category":"PRE_VALIDATION","message":"Pre-validation successful, OrderDetailsDTO received","file":"service.go","line":291}
{"timestamp":"2025-10-07T11:37:57.362Z","level":"DEBUG","category":"REDIS","message":"Attempting to lock seats in Redis","file":"service.go","line":294}
{"timestamp":"2025-10-07T11:37:59.373Z","level":"INFO","category":"REDIS","message":"Seats locked successfully","file":"service.go","line":304}
{"timestamp":"2025-10-07T11:37:59.373Z","level":"DEBUG","category":"SEAT_VALIDATION","message":"Making second HTTP request to validate seats after locking","file":"service.go","line":313}
{"timestamp":"2025-10-07T11:37:59.418Z","level":"INFO","category":"SEAT_VALIDATION","message":"Final seat validation successful","file":"service.go","line":349}
{"timestamp":"2025-10-07T11:38:00.423Z","level":"INFO","category":"KAFKA","message":"Published seats locked event for 1 seats","file":"service.go","line":533}
{"timestamp":"2025-10-07T11:38:00.423Z","level":"DEBUG","category":"DISCOUNT","message":"Processing discount from OrderDetailsDTO: SAVE10","file":"service.go","line":370}
{"timestamp":"2025-10-07T11:38:00.423Z","level":"INFO","category":"DISCOUNT","message":"Applied discount: 150.00, final price: 1350.00","file":"service.go","line":401}
{"timestamp":"2025-10-07T11:38:00.423Z","level":"INFO","category":"ORDER","message":"Placing order: 875c83fa-a21f-4ad9-981c-d078f6767e44 for session: 0e16aca6-92dd-4847-b952-31552963c335","file":"service.go","line":72}
{"timestamp":"2025-10-07T11:38:00.423Z","level":"DEBUG","category":"ORDER","message":"Locking seats...","file":"service.go","line":75}
{"timestamp":"2025-10-07T11:38:00.423Z","level":"ERROR","category":"ORDER","message":"Failed to lock seats: one or more seats already locked","file":"service.go","line":82}
{"timestamp":"2025-10-07T11:38:00.423Z","level":"ERROR","category":"ORDER","message":"Failed to place order: one or more seats already locked. Unlocking seats.","file":"service.go","line":420}
{"timestamp":"2025-10-07T11:38:00.423Z","level":"WARN","category":"TXN","message":"Rolling back: unlocking seats","file":"service.go","line":308}
{"timestamp":"2025-10-07T11:38:02.432Z","level":"ERROR","category":"API","message":"SeatValidationAndPlaceOrder: seat validation failed: failed to place order: one or more seats already locked","file":"handler.go","line":271}
{"timestamp":"2025-10-07T12:14:20.352Z","level":"INFO","category":"API","message":"SeatValidationAndPlaceOrder: received request","file":"handler.go","line":254}
{"timestamp":"2025-10-07T12:14:20.352Z","level":"DEBUG","category":"API","message":"SeatValidationAndPlaceOrder: SessionID: 0e16aca6-92dd-4847-b952-31552963c335","file":"handler.go","line":265}
{"timestamp":"2025-10-07T12:14:20.354Z","level":"DEBUG","category":"API","message":"SeatValidationAndPlaceOrder: SeatIDs: [04cf511e-a6b2-4f83-b164-383f8139d825]","file":"handler.go","line":266}
{"timestamp":"2025-10-07T12:14:20.354Z","level":"INFO","category":"ORDER","message":"Starting seat validation and order placement process","file":"service.go","line":210}
{"timestamp":"2025-10-07T12:14:20.354Z","level":"DEBUG","category":"ORDER","message":"Order request: {SessionID:0e16aca6-92dd-4847-b952-31552963c335 EventID:79955f7b-3735-4dce-a112-ba0ef29d36bd SeatIDs:[04cf511e-a6b2-4f83-b164-383f8139d825] DiscountID:6e52d131-9994-49d2-86e2-99b16c2178d4}","file":"service.go","line":225}
{"timestamp":"2025-10-07T12:14:20.354Z","level":"DEBUG","category":"AUTH","message":"Requesting M2M token for seat validation","file":"service.go","line":233}
{"timestamp":"2025-10-07T12:14:20.368Z","level":"DEBUG","category":"ORDER","message":"Generated order ID: 5f1be6aa-2041-41a3-a850-0158ccf3189e","file":"service.go","line":242}
{"timestamp":"2025-10-07T12:14:20.368Z","level":"DEBUG","category":"PRE_VALIDATION","message":"Making first HTTP request to validate pre-order","file":"service.go","line":245}
{"timestamp":"2025-10-07T12:14:20.368Z","level":"DEBUG","category":"PRE_VALIDATION","message":"Pre-validation URL: http://localhost:8082/api/event-query/internal/v1/validate-pre-order","file":"service.go","line":260}
{"timestamp":"2025-10-07T12:14:20.368Z","level":"DEBUG","category":"PRE_VALIDATION","message":"Request body: {\"session_id\":\"0e16aca6-92dd-4847-b952-31552963c335\",\"event_id\":\"79955f7b-3735-4dce-a112-ba0ef29d36bd\",\"seat_ids\":[\"04cf511e-a6b2-4f83-b164-383f8139d825\"],\"discount_id\":\"6e52d131-9994-49d2-86e2-99b16c2178d4\"}","file":"service.go","line":261}
{"timestamp":"2025-10-07T12:14:20.368Z","level":"ERROR","category":"PRE_VALIDATION","message":"Pre-validation service error: Post \"http://localhost:8082/api/event-query/internal/v1/validate-pre-order\": dial tcp [::1]:8082: connect: connection refused","file":"service.go","line":273}
{"timestamp":"2025-10-07T12:14:20.368Z","level":"ERROR","category":"API","message":"SeatValidationAndPlaceOrder: seat validation failed: pre-validation service error: Post \"http://localhost:8082/api/event-query/internal/v1/validate-pre-order\": dial tcp [::1]:8082: connect: connection refused","file":"handler.go","line":271}
{"timestamp":"2025-10-07T12:14:49.444Z","level":"INFO","category":"APP","message":"Shutdown signal received, initiating graceful shutdown","file":"main.go","line":316}
{"timestamp":"2025-10-07T12:14:49.445Z","level":"INFO","category":"HTTP","message":"âœ… Order Service shutdown complete","file":"main.go","line":323}
{"timestamp":"2025-10-07T12:14:49.445Z","level":"INFO","category":"DATABASE","message":"Redis connection closed","file":"main.go","line":208}
{"timestamp":"2025-10-07T12:14:49.445Z","level":"INFO","category":"DATABASE","message":"PostgreSQL connection closed","file":"main.go","line":204}
{"timestamp":"2025-10-07T12:14:49.445Z","level":"INFO","category":"LOGGER","message":"Closing log file","file":"logger.go","line":216}
{"timestamp":"2025-10-07T12:14:51.292Z","level":"INFO","category":"LOGGER","message":"Enhanced logging system initialized","file":"logger.go","line":68}
{"timestamp":"2025-10-07T12:14:51.292Z","level":"INFO","category":"LOGGER","message":"Log file: logs/order-gateway-2025-10-07.log","file":"logger.go","line":69}
{"timestamp":"2025-10-07T12:14:51.292Z","level":"INFO","category":"APP","message":"Starting Order Service initialization","file":"main.go","line":185}
{"timestamp":"2025-10-07T12:14:51.293Z","level":"INFO","category":"CONFIG","message":"Loaded environment variables from .env file","file":"main.go","line":191}
{"timestamp":"2025-10-07T12:14:51.293Z","level":"INFO","category":"APP","message":"Verifying database connections","file":"main.go","line":199}
{"timestamp":"2025-10-07T12:14:51.293Z","level":"INFO","category":"DATABASE","message":"Attempting to connect to PostgreSQL (attempt 1/5)","file":"main.go","line":121}
{"timestamp":"2025-10-07T12:14:51.301Z","level":"INFO","category":"DATABASE","message":"âœ… PostgreSQL connection successful","file":"main.go","line":145}
{"timestamp":"2025-10-07T12:14:51.311Z","level":"INFO","category":"REDIS","message":"Keyspace notifications enabled for expired events","file":"main.go","line":166}
{"timestamp":"2025-10-07T12:14:51.311Z","level":"INFO","category":"DATABASE","message":"âœ… Redis connection successful to localhost:6379 (DB: 0)","file":"main.go","line":168}
{"timestamp":"2025-10-07T12:14:51.311Z","level":"INFO","category":"KAFKA","message":"Initializing Kafka producer","file":"main.go","line":211}
{"timestamp":"2025-10-07T12:14:51.311Z","level":"INFO","category":"KAFKA","message":"Using Kafka address from environment variable: localhost:9092","file":"main.go","line":214}
{"timestamp":"2025-10-07T12:14:51.311Z","level":"INFO","category":"KAFKA","message":"Kafka brokers configured: [localhost:9092]","file":"main.go","line":216}
{"timestamp":"2025-10-07T12:14:51.311Z","level":"INFO","category":"KAFKA","message":"Kafka producer initialized successfully","file":"main.go","line":218}
{"timestamp":"2025-10-07T12:14:51.311Z","level":"INFO","category":"KAFKA","message":"Ensuring required topics exist","file":"main.go","line":221}
{"timestamp":"2025-10-07T12:14:52.335Z","level":"INFO","category":"KAFKA","message":"Required topics ensured successfully","file":"main.go","line":234}
{"timestamp":"2025-10-07T12:14:52.335Z","level":"INFO","category":"SERVICE","message":"Initializing ticket service","file":"main.go","line":237}
{"timestamp":"2025-10-07T12:14:52.335Z","level":"INFO","category":"SERVICE","message":"Initializing order service","file":"main.go","line":240}
{"timestamp":"2025-10-07T12:14:52.335Z","level":"INFO","category":"LOGGER","message":"Enhanced logging system initialized","file":"logger.go","line":68}
{"timestamp":"2025-10-07T12:14:52.336Z","level":"INFO","category":"LOGGER","message":"Log file: logs/order-gateway-2025-10-07.log","file":"logger.go","line":69}
{"timestamp":"2025-10-07T12:14:52.336Z","level":"INFO","category":"LOGGER","message":"Enhanced logging system initialized","file":"logger.go","line":68}
{"timestamp":"2025-10-07T12:14:52.336Z","level":"INFO","category":"LOGGER","message":"Log file: logs/order-gateway-2025-10-07.log","file":"logger.go","line":69}
{"timestamp":"2025-10-07T12:14:52.336Z","level":"INFO","category":"HTTP","message":"Setting up router and middleware","file":"main.go","line":259}
{"timestamp":"2025-10-07T12:14:52.343Z","level":"INFO","category":"AUTH","message":"JWT middleware applied globally","file":"main.go","line":265}
{"timestamp":"2025-10-07T12:14:52.343Z","level":"INFO","category":"ROUTER","message":"Order routes registered under /api/order","file":"main.go","line":279}
{"timestamp":"2025-10-07T12:14:52.343Z","level":"INFO","category":"ROUTER","message":"Ticket routes registered under /api/order/ticket","file":"main.go","line":289}
{"timestamp":"2025-10-07T12:14:52.343Z","level":"INFO","category":"REDIS","message":"Starting seat unlock subscription","file":"main.go","line":299}
{"timestamp":"2025-10-07T12:14:52.344Z","level":"INFO","category":"REDIS","message":"Current keyspace notifications setting: [notify-keyspace-events xE]","file":"main.go","line":48}
{"timestamp":"2025-10-07T12:14:52.344Z","level":"INFO","category":"REDIS","message":"Subscribed to Redis keyevent expired notifications (DB 0)","file":"main.go","line":55}
{"timestamp":"2025-10-07T12:14:52.345Z","level":"INFO","category":"HTTP","message":"ðŸš€ Order Service running on :8084","file":"main.go","line":304}
{"timestamp":"2025-10-07T12:14:52.345Z","level":"INFO","category":"APP","message":"Service started successfully, waiting for shutdown signal","file":"main.go","line":313}
{"timestamp":"2025-10-07T12:14:56.788Z","level":"INFO","category":"API","message":"SeatValidationAndPlaceOrder: received request","file":"handler.go","line":254}
{"timestamp":"2025-10-07T12:14:56.788Z","level":"DEBUG","category":"API","message":"SeatValidationAndPlaceOrder: SessionID: 0e16aca6-92dd-4847-b952-31552963c335","file":"handler.go","line":265}
{"timestamp":"2025-10-07T12:14:56.788Z","level":"DEBUG","category":"API","message":"SeatValidationAndPlaceOrder: SeatIDs: [04cf511e-a6b2-4f83-b164-383f8139d825]","file":"handler.go","line":266}
{"timestamp":"2025-10-07T12:14:56.788Z","level":"INFO","category":"ORDER","message":"Starting seat validation and order placement process","file":"service.go","line":210}
{"timestamp":"2025-10-07T12:14:56.789Z","level":"DEBUG","category":"ORDER","message":"Order request: {SessionID:0e16aca6-92dd-4847-b952-31552963c335 EventID:79955f7b-3735-4dce-a112-ba0ef29d36bd SeatIDs:[04cf511e-a6b2-4f83-b164-383f8139d825] DiscountID:6e52d131-9994-49d2-86e2-99b16c2178d4}","file":"service.go","line":225}
{"timestamp":"2025-10-07T12:14:56.789Z","level":"DEBUG","category":"AUTH","message":"Requesting M2M token for seat validation","file":"service.go","line":233}
{"timestamp":"2025-10-07T12:14:56.801Z","level":"DEBUG","category":"ORDER","message":"Generated order ID: ce7f5e45-fbe4-4e1c-ab9b-01baabe6a80c","file":"service.go","line":242}
{"timestamp":"2025-10-07T12:14:56.801Z","level":"DEBUG","category":"PRE_VALIDATION","message":"Making first HTTP request to validate pre-order","file":"service.go","line":245}
{"timestamp":"2025-10-07T12:14:56.801Z","level":"DEBUG","category":"PRE_VALIDATION","message":"Pre-validation URL: http://localhost:8082/api/event-query/internal/v1/validate-pre-order","file":"service.go","line":260}
{"timestamp":"2025-10-07T12:14:56.801Z","level":"DEBUG","category":"PRE_VALIDATION","message":"Request body: {\"session_id\":\"0e16aca6-92dd-4847-b952-31552963c335\",\"event_id\":\"79955f7b-3735-4dce-a112-ba0ef29d36bd\",\"seat_ids\":[\"04cf511e-a6b2-4f83-b164-383f8139d825\"],\"discount_id\":\"6e52d131-9994-49d2-86e2-99b16c2178d4\"}","file":"service.go","line":261}
{"timestamp":"2025-10-07T12:14:57.451Z","level":"INFO","category":"PRE_VALIDATION","message":"Pre-validation successful, OrderDetailsDTO received","file":"service.go","line":291}
{"timestamp":"2025-10-07T12:14:57.451Z","level":"DEBUG","category":"REDIS","message":"Attempting to lock seats in Redis","file":"service.go","line":294}
{"timestamp":"2025-10-07T12:14:59.462Z","level":"INFO","category":"REDIS","message":"Seats locked successfully","file":"service.go","line":304}
{"timestamp":"2025-10-07T12:14:59.462Z","level":"DEBUG","category":"SEAT_VALIDATION","message":"Making second HTTP request to validate seats after locking","file":"service.go","line":313}
{"timestamp":"2025-10-07T12:14:59.658Z","level":"INFO","category":"SEAT_VALIDATION","message":"Final seat validation successful","file":"service.go","line":349}
{"timestamp":"2025-10-07T12:15:00.665Z","level":"INFO","category":"KAFKA","message":"Published seats locked event for 1 seats","file":"service.go","line":533}
{"timestamp":"2025-10-07T12:15:00.665Z","level":"DEBUG","category":"DISCOUNT","message":"Processing discount from OrderDetailsDTO: SAVE10","file":"service.go","line":370}
{"timestamp":"2025-10-07T12:15:00.665Z","level":"INFO","category":"DISCOUNT","message":"Applied discount: 150.00, final price: 1350.00","file":"service.go","line":401}
{"timestamp":"2025-10-07T12:15:00.665Z","level":"INFO","category":"ORDER","message":"Placing order: ce7f5e45-fbe4-4e1c-ab9b-01baabe6a80c for session: 0e16aca6-92dd-4847-b952-31552963c335","file":"service.go","line":72}
{"timestamp":"2025-10-07T12:15:00.665Z","level":"DEBUG","category":"ORDER","message":"Locking seats...","file":"service.go","line":75}
{"timestamp":"2025-10-07T12:15:00.666Z","level":"ERROR","category":"ORDER","message":"Failed to lock seats: one or more seats already locked","file":"service.go","line":82}
{"timestamp":"2025-10-07T12:15:00.666Z","level":"ERROR","category":"ORDER","message":"Failed to place order: one or more seats already locked. Unlocking seats.","file":"service.go","line":420}
{"timestamp":"2025-10-07T12:15:00.666Z","level":"WARN","category":"TXN","message":"Rolling back: unlocking seats","file":"service.go","line":308}
{"timestamp":"2025-10-07T12:15:02.673Z","level":"ERROR","category":"API","message":"SeatValidationAndPlaceOrder: seat validation failed: failed to place order: one or more seats already locked","file":"handler.go","line":271}
{"timestamp":"2025-10-07T12:18:56.635Z","level":"INFO","category":"APP","message":"Shutdown signal received, initiating graceful shutdown","file":"main.go","line":316}
{"timestamp":"2025-10-07T12:18:56.635Z","level":"INFO","category":"HTTP","message":"âœ… Order Service shutdown complete","file":"main.go","line":323}
{"timestamp":"2025-10-07T12:18:56.636Z","level":"INFO","category":"DATABASE","message":"Redis connection closed","file":"main.go","line":208}
{"timestamp":"2025-10-07T12:18:56.636Z","level":"INFO","category":"DATABASE","message":"PostgreSQL connection closed","file":"main.go","line":204}
{"timestamp":"2025-10-07T12:18:56.636Z","level":"INFO","category":"LOGGER","message":"Closing log file","file":"logger.go","line":216}
{"timestamp":"2025-10-07T12:18:58.140Z","level":"INFO","category":"LOGGER","message":"Enhanced logging system initialized","file":"logger.go","line":68}
{"timestamp":"2025-10-07T12:18:58.140Z","level":"INFO","category":"LOGGER","message":"Log file: logs/order-gateway-2025-10-07.log","file":"logger.go","line":69}
{"timestamp":"2025-10-07T12:18:58.140Z","level":"INFO","category":"APP","message":"Starting Order Service initialization","file":"main.go","line":185}
{"timestamp":"2025-10-07T12:18:58.141Z","level":"INFO","category":"CONFIG","message":"Loaded environment variables from .env file","file":"main.go","line":191}
{"timestamp":"2025-10-07T12:18:58.141Z","level":"INFO","category":"APP","message":"Verifying database connections","file":"main.go","line":199}
{"timestamp":"2025-10-07T12:18:58.141Z","level":"INFO","category":"DATABASE","message":"Attempting to connect to PostgreSQL (attempt 1/5)","file":"main.go","line":121}
{"timestamp":"2025-10-07T12:18:58.146Z","level":"INFO","category":"DATABASE","message":"âœ… PostgreSQL connection successful","file":"main.go","line":145}
{"timestamp":"2025-10-07T12:18:58.147Z","level":"INFO","category":"REDIS","message":"Keyspace notifications enabled for expired events","file":"main.go","line":166}
{"timestamp":"2025-10-07T12:18:58.147Z","level":"INFO","category":"DATABASE","message":"âœ… Redis connection successful to localhost:6379 (DB: 0)","file":"main.go","line":168}
{"timestamp":"2025-10-07T12:18:58.147Z","level":"INFO","category":"KAFKA","message":"Initializing Kafka producer","file":"main.go","line":211}
{"timestamp":"2025-10-07T12:18:58.147Z","level":"INFO","category":"KAFKA","message":"Using Kafka address from environment variable: localhost:9092","file":"main.go","line":214}
{"timestamp":"2025-10-07T12:18:58.147Z","level":"INFO","category":"KAFKA","message":"Kafka brokers configured: [localhost:9092]","file":"main.go","line":216}
{"timestamp":"2025-10-07T12:18:58.147Z","level":"INFO","category":"KAFKA","message":"Kafka producer initialized successfully","file":"main.go","line":218}
{"timestamp":"2025-10-07T12:18:58.147Z","level":"INFO","category":"KAFKA","message":"Ensuring required topics exist","file":"main.go","line":221}
{"timestamp":"2025-10-07T12:18:59.158Z","level":"INFO","category":"KAFKA","message":"Required topics ensured successfully","file":"main.go","line":234}
{"timestamp":"2025-10-07T12:18:59.158Z","level":"INFO","category":"SERVICE","message":"Initializing ticket service","file":"main.go","line":237}
{"timestamp":"2025-10-07T12:18:59.158Z","level":"INFO","category":"SERVICE","message":"Initializing order service","file":"main.go","line":240}
{"timestamp":"2025-10-07T12:18:59.158Z","level":"INFO","category":"LOGGER","message":"Enhanced logging system initialized","file":"logger.go","line":68}
{"timestamp":"2025-10-07T12:18:59.158Z","level":"INFO","category":"LOGGER","message":"Log file: logs/order-gateway-2025-10-07.log","file":"logger.go","line":69}
{"timestamp":"2025-10-07T12:18:59.158Z","level":"INFO","category":"LOGGER","message":"Enhanced logging system initialized","file":"logger.go","line":68}
{"timestamp":"2025-10-07T12:18:59.158Z","level":"INFO","category":"LOGGER","message":"Log file: logs/order-gateway-2025-10-07.log","file":"logger.go","line":69}
{"timestamp":"2025-10-07T12:18:59.161Z","level":"INFO","category":"HTTP","message":"Setting up router and middleware","file":"main.go","line":259}
{"timestamp":"2025-10-07T12:18:59.166Z","level":"INFO","category":"AUTH","message":"JWT middleware applied globally","file":"main.go","line":265}
{"timestamp":"2025-10-07T12:18:59.167Z","level":"INFO","category":"ROUTER","message":"Order routes registered under /api/order","file":"main.go","line":279}
{"timestamp":"2025-10-07T12:18:59.167Z","level":"INFO","category":"ROUTER","message":"Ticket routes registered under /api/order/ticket","file":"main.go","line":289}
{"timestamp":"2025-10-07T12:18:59.167Z","level":"INFO","category":"REDIS","message":"Starting seat unlock subscription","file":"main.go","line":299}
{"timestamp":"2025-10-07T12:18:59.167Z","level":"INFO","category":"REDIS","message":"Current keyspace notifications setting: [notify-keyspace-events xE]","file":"main.go","line":48}
{"timestamp":"2025-10-07T12:18:59.167Z","level":"INFO","category":"REDIS","message":"Subscribed to Redis keyevent expired notifications (DB 0)","file":"main.go","line":55}
{"timestamp":"2025-10-07T12:18:59.168Z","level":"INFO","category":"HTTP","message":"ðŸš€ Order Service running on :8084","file":"main.go","line":304}
{"timestamp":"2025-10-07T12:18:59.168Z","level":"INFO","category":"APP","message":"Service started successfully, waiting for shutdown signal","file":"main.go","line":313}
{"timestamp":"2025-10-07T12:19:05.371Z","level":"INFO","category":"API","message":"SeatValidationAndPlaceOrder: received request","file":"handler.go","line":254}
{"timestamp":"2025-10-07T12:19:05.372Z","level":"DEBUG","category":"API","message":"SeatValidationAndPlaceOrder: SessionID: 0e16aca6-92dd-4847-b952-31552963c335","file":"handler.go","line":265}
{"timestamp":"2025-10-07T12:19:05.372Z","level":"DEBUG","category":"API","message":"SeatValidationAndPlaceOrder: SeatIDs: [04cf511e-a6b2-4f83-b164-383f8139d825]","file":"handler.go","line":266}
{"timestamp":"2025-10-07T12:19:05.372Z","level":"INFO","category":"ORDER","message":"Starting seat validation and order placement process","file":"service.go","line":214}
{"timestamp":"2025-10-07T12:19:05.372Z","level":"DEBUG","category":"ORDER","message":"Order request: {SessionID:0e16aca6-92dd-4847-b952-31552963c335 EventID:79955f7b-3735-4dce-a112-ba0ef29d36bd SeatIDs:[04cf511e-a6b2-4f83-b164-383f8139d825] DiscountID:6e52d131-9994-49d2-86e2-99b16c2178d4}","file":"service.go","line":229}
{"timestamp":"2025-10-07T12:19:05.372Z","level":"DEBUG","category":"AUTH","message":"Requesting M2M token for seat validation","file":"service.go","line":237}
{"timestamp":"2025-10-07T12:19:05.380Z","level":"DEBUG","category":"ORDER","message":"Generated order ID: 1ecdb61b-b472-47ab-b283-147a64c7fe0c","file":"service.go","line":246}
{"timestamp":"2025-10-07T12:19:05.380Z","level":"DEBUG","category":"PRE_VALIDATION","message":"Making first HTTP request to validate pre-order","file":"service.go","line":249}
{"timestamp":"2025-10-07T12:19:05.380Z","level":"DEBUG","category":"PRE_VALIDATION","message":"Pre-validation URL: http://localhost:8082/api/event-query/internal/v1/validate-pre-order","file":"service.go","line":264}
{"timestamp":"2025-10-07T12:19:05.380Z","level":"DEBUG","category":"PRE_VALIDATION","message":"Request body: {\"session_id\":\"0e16aca6-92dd-4847-b952-31552963c335\",\"event_id\":\"79955f7b-3735-4dce-a112-ba0ef29d36bd\",\"seat_ids\":[\"04cf511e-a6b2-4f83-b164-383f8139d825\"],\"discount_id\":\"6e52d131-9994-49d2-86e2-99b16c2178d4\"}","file":"service.go","line":265}
{"timestamp":"2025-10-07T12:19:05.508Z","level":"ERROR","category":"PRE_VALIDATION","message":"Pre-validation failed: status 400","file":"service.go","line":291}
{"timestamp":"2025-10-07T12:19:05.508Z","level":"ERROR","category":"API","message":"SeatValidationAndPlaceOrder: seat validation failed: pre-validation failed: status 400","file":"handler.go","line":271}
{"timestamp":"2025-10-07T12:19:57.210Z","level":"INFO","category":"API","message":"SeatValidationAndPlaceOrder: received request","file":"handler.go","line":254}
{"timestamp":"2025-10-07T12:19:57.210Z","level":"DEBUG","category":"API","message":"SeatValidationAndPlaceOrder: SessionID: 0e16aca6-92dd-4847-b952-31552963c335","file":"handler.go","line":265}
{"timestamp":"2025-10-07T12:19:57.210Z","level":"DEBUG","category":"API","message":"SeatValidationAndPlaceOrder: SeatIDs: [628324d0-1efc-4dbb-a2f0-86b23283415a]","file":"handler.go","line":266}
{"timestamp":"2025-10-07T12:19:57.210Z","level":"INFO","category":"ORDER","message":"Starting seat validation and order placement process","file":"service.go","line":214}
{"timestamp":"2025-10-07T12:19:57.210Z","level":"DEBUG","category":"ORDER","message":"Order request: {SessionID:0e16aca6-92dd-4847-b952-31552963c335 EventID:79955f7b-3735-4dce-a112-ba0ef29d36bd SeatIDs:[628324d0-1efc-4dbb-a2f0-86b23283415a] DiscountID:}","file":"service.go","line":229}
{"timestamp":"2025-10-07T12:19:57.210Z","level":"DEBUG","category":"AUTH","message":"Requesting M2M token for seat validation","file":"service.go","line":237}
{"timestamp":"2025-10-07T12:19:57.216Z","level":"DEBUG","category":"ORDER","message":"Generated order ID: a7006269-6a7a-4023-a8d5-cba08bd9a6eb","file":"service.go","line":246}
{"timestamp":"2025-10-07T12:19:57.216Z","level":"DEBUG","category":"PRE_VALIDATION","message":"Making first HTTP request to validate pre-order","file":"service.go","line":249}
{"timestamp":"2025-10-07T12:19:57.216Z","level":"DEBUG","category":"PRE_VALIDATION","message":"Pre-validation URL: http://localhost:8082/api/event-query/internal/v1/validate-pre-order","file":"service.go","line":264}
{"timestamp":"2025-10-07T12:19:57.216Z","level":"DEBUG","category":"PRE_VALIDATION","message":"Request body: {\"session_id\":\"0e16aca6-92dd-4847-b952-31552963c335\",\"event_id\":\"79955f7b-3735-4dce-a112-ba0ef29d36bd\",\"seat_ids\":[\"628324d0-1efc-4dbb-a2f0-86b23283415a\"],\"discount_id\":\"\"}","file":"service.go","line":265}
{"timestamp":"2025-10-07T12:19:57.234Z","level":"ERROR","category":"PRE_VALIDATION","message":"Pre-validation failed: status 400","file":"service.go","line":291}
{"timestamp":"2025-10-07T12:19:57.234Z","level":"ERROR","category":"API","message":"SeatValidationAndPlaceOrder: seat validation failed: pre-validation failed: status 400","file":"handler.go","line":271}
{"timestamp":"2025-10-07T12:20:12.158Z","level":"INFO","category":"APP","message":"Shutdown signal received, initiating graceful shutdown","file":"main.go","line":316}
{"timestamp":"2025-10-07T12:20:12.159Z","level":"INFO","category":"HTTP","message":"âœ… Order Service shutdown complete","file":"main.go","line":323}
{"timestamp":"2025-10-07T12:20:12.159Z","level":"INFO","category":"DATABASE","message":"Redis connection closed","file":"main.go","line":208}
{"timestamp":"2025-10-07T12:20:12.159Z","level":"INFO","category":"DATABASE","message":"PostgreSQL connection closed","file":"main.go","line":204}
{"timestamp":"2025-10-07T12:20:12.159Z","level":"INFO","category":"LOGGER","message":"Closing log file","file":"logger.go","line":216}
{"timestamp":"2025-10-07T12:20:14.069Z","level":"INFO","category":"LOGGER","message":"Enhanced logging system initialized","file":"logger.go","line":68}
{"timestamp":"2025-10-07T12:20:14.069Z","level":"INFO","category":"LOGGER","message":"Log file: logs/order-gateway-2025-10-07.log","file":"logger.go","line":69}
{"timestamp":"2025-10-07T12:20:14.069Z","level":"INFO","category":"APP","message":"Starting Order Service initialization","file":"main.go","line":185}
{"timestamp":"2025-10-07T12:20:14.070Z","level":"INFO","category":"CONFIG","message":"Loaded environment variables from .env file","file":"main.go","line":191}
{"timestamp":"2025-10-07T12:20:14.070Z","level":"INFO","category":"APP","message":"Verifying database connections","file":"main.go","line":199}
{"timestamp":"2025-10-07T12:20:14.070Z","level":"INFO","category":"DATABASE","message":"Attempting to connect to PostgreSQL (attempt 1/5)","file":"main.go","line":121}
{"timestamp":"2025-10-07T12:20:14.078Z","level":"INFO","category":"DATABASE","message":"âœ… PostgreSQL connection successful","file":"main.go","line":145}
{"timestamp":"2025-10-07T12:20:14.079Z","level":"INFO","category":"REDIS","message":"Keyspace notifications enabled for expired events","file":"main.go","line":166}
{"timestamp":"2025-10-07T12:20:14.079Z","level":"INFO","category":"DATABASE","message":"âœ… Redis connection successful to localhost:6379 (DB: 0)","file":"main.go","line":168}
{"timestamp":"2025-10-07T12:20:14.079Z","level":"INFO","category":"KAFKA","message":"Initializing Kafka producer","file":"main.go","line":211}
{"timestamp":"2025-10-07T12:20:14.079Z","level":"INFO","category":"KAFKA","message":"Using Kafka address from environment variable: localhost:9092","file":"main.go","line":214}
{"timestamp":"2025-10-07T12:20:14.079Z","level":"INFO","category":"KAFKA","message":"Kafka brokers configured: [localhost:9092]","file":"main.go","line":216}
{"timestamp":"2025-10-07T12:20:14.079Z","level":"INFO","category":"KAFKA","message":"Kafka producer initialized successfully","file":"main.go","line":218}
{"timestamp":"2025-10-07T12:20:14.079Z","level":"INFO","category":"KAFKA","message":"Ensuring required topics exist","file":"main.go","line":221}
{"timestamp":"2025-10-07T12:20:15.088Z","level":"INFO","category":"KAFKA","message":"Required topics ensured successfully","file":"main.go","line":234}
{"timestamp":"2025-10-07T12:20:15.088Z","level":"INFO","category":"SERVICE","message":"Initializing ticket service","file":"main.go","line":237}
{"timestamp":"2025-10-07T12:20:15.088Z","level":"INFO","category":"SERVICE","message":"Initializing order service","file":"main.go","line":240}
{"timestamp":"2025-10-07T12:20:15.088Z","level":"INFO","category":"LOGGER","message":"Enhanced logging system initialized","file":"logger.go","line":68}
{"timestamp":"2025-10-07T12:20:15.088Z","level":"INFO","category":"LOGGER","message":"Log file: logs/order-gateway-2025-10-07.log","file":"logger.go","line":69}
{"timestamp":"2025-10-07T12:20:15.088Z","level":"INFO","category":"LOGGER","message":"Enhanced logging system initialized","file":"logger.go","line":68}
{"timestamp":"2025-10-07T12:20:15.088Z","level":"INFO","category":"LOGGER","message":"Log file: logs/order-gateway-2025-10-07.log","file":"logger.go","line":69}
{"timestamp":"2025-10-07T12:20:15.088Z","level":"INFO","category":"HTTP","message":"Setting up router and middleware","file":"main.go","line":259}
{"timestamp":"2025-10-07T12:20:15.093Z","level":"INFO","category":"AUTH","message":"JWT middleware applied globally","file":"main.go","line":265}
{"timestamp":"2025-10-07T12:20:15.093Z","level":"INFO","category":"ROUTER","message":"Order routes registered under /api/order","file":"main.go","line":279}
{"timestamp":"2025-10-07T12:20:15.093Z","level":"INFO","category":"ROUTER","message":"Ticket routes registered under /api/order/ticket","file":"main.go","line":289}
{"timestamp":"2025-10-07T12:20:15.093Z","level":"INFO","category":"REDIS","message":"Starting seat unlock subscription","file":"main.go","line":299}
{"timestamp":"2025-10-07T12:20:15.094Z","level":"INFO","category":"REDIS","message":"Current keyspace notifications setting: [notify-keyspace-events xE]","file":"main.go","line":48}
{"timestamp":"2025-10-07T12:20:15.094Z","level":"INFO","category":"REDIS","message":"Subscribed to Redis keyevent expired notifications (DB 0)","file":"main.go","line":55}
{"timestamp":"2025-10-07T12:20:15.094Z","level":"INFO","category":"HTTP","message":"ðŸš€ Order Service running on :8084","file":"main.go","line":304}
{"timestamp":"2025-10-07T12:20:15.094Z","level":"INFO","category":"APP","message":"Service started successfully, waiting for shutdown signal","file":"main.go","line":313}
{"timestamp":"2025-10-07T12:20:32.850Z","level":"INFO","category":"API","message":"SeatValidationAndPlaceOrder: received request","file":"handler.go","line":254}
{"timestamp":"2025-10-07T12:20:32.850Z","level":"DEBUG","category":"API","message":"SeatValidationAndPlaceOrder: SessionID: 0e16aca6-92dd-4847-b952-31552963c335","file":"handler.go","line":265}
{"timestamp":"2025-10-07T12:20:32.850Z","level":"DEBUG","category":"API","message":"SeatValidationAndPlaceOrder: SeatIDs: [628324d0-1efc-4dbb-a2f0-86b23283415a]","file":"handler.go","line":266}
{"timestamp":"2025-10-07T12:20:32.850Z","level":"INFO","category":"ORDER","message":"Starting seat validation and order placement process","file":"service.go","line":214}
{"timestamp":"2025-10-07T12:20:32.850Z","level":"DEBUG","category":"ORDER","message":"Order request: {SessionID:0e16aca6-92dd-4847-b952-31552963c335 EventID:79955f7b-3735-4dce-a112-ba0ef29d36bd SeatIDs:[628324d0-1efc-4dbb-a2f0-86b23283415a] DiscountID:}","file":"service.go","line":229}
{"timestamp":"2025-10-07T12:20:32.850Z","level":"DEBUG","category":"AUTH","message":"Requesting M2M token for seat validation","file":"service.go","line":237}
{"timestamp":"2025-10-07T12:20:32.858Z","level":"DEBUG","category":"ORDER","message":"Generated order ID: 8759b6a8-0076-4e10-aeb2-1639d6ffe7c6","file":"service.go","line":246}
{"timestamp":"2025-10-07T12:20:32.859Z","level":"DEBUG","category":"PRE_VALIDATION","message":"Making first HTTP request to validate pre-order","file":"service.go","line":249}
{"timestamp":"2025-10-07T12:20:32.859Z","level":"DEBUG","category":"PRE_VALIDATION","message":"Pre-validation URL: http://localhost:8082/api/event-query/internal/v1/validate-pre-order","file":"service.go","line":264}
{"timestamp":"2025-10-07T12:20:32.859Z","level":"DEBUG","category":"PRE_VALIDATION","message":"Request body: {\"session_id\":\"0e16aca6-92dd-4847-b952-31552963c335\",\"event_id\":\"79955f7b-3735-4dce-a112-ba0ef29d36bd\",\"seat_ids\":[\"628324d0-1efc-4dbb-a2f0-86b23283415a\"],\"discount_id\":\"\"}","file":"service.go","line":265}
{"timestamp":"2025-10-07T12:20:32.886Z","level":"ERROR","category":"PRE_VALIDATION","message":"Pre-validation failed: status 400","file":"service.go","line":291}
{"timestamp":"2025-10-07T12:20:32.886Z","level":"ERROR","category":"API","message":"SeatValidationAndPlaceOrder: seat validation failed: pre-validation failed: status 400","file":"handler.go","line":271}
{"timestamp":"2025-10-07T12:21:35.358Z","level":"INFO","category":"API","message":"SeatValidationAndPlaceOrder: received request","file":"handler.go","line":254}
{"timestamp":"2025-10-07T12:21:35.358Z","level":"DEBUG","category":"API","message":"SeatValidationAndPlaceOrder: SessionID: 0e16aca6-92dd-4847-b952-31552963c335","file":"handler.go","line":265}
{"timestamp":"2025-10-07T12:21:35.358Z","level":"DEBUG","category":"API","message":"SeatValidationAndPlaceOrder: SeatIDs: [628324d0-1efc-4dbb-a2f0-86b23283415a]","file":"handler.go","line":266}
{"timestamp":"2025-10-07T12:21:35.358Z","level":"INFO","category":"ORDER","message":"Starting seat validation and order placement process","file":"service.go","line":214}
{"timestamp":"2025-10-07T12:21:35.358Z","level":"DEBUG","category":"ORDER","message":"Order request: {SessionID:0e16aca6-92dd-4847-b952-31552963c335 EventID:79955f7b-3735-4dce-a112-ba0ef29d36bd SeatIDs:[628324d0-1efc-4dbb-a2f0-86b23283415a] DiscountID:}","file":"service.go","line":229}
{"timestamp":"2025-10-07T12:21:35.359Z","level":"DEBUG","category":"AUTH","message":"Requesting M2M token for seat validation","file":"service.go","line":237}
{"timestamp":"2025-10-07T12:21:35.376Z","level":"DEBUG","category":"ORDER","message":"Generated order ID: f0de918a-dbee-4a17-ab47-f1e424c9e637","file":"service.go","line":246}
{"timestamp":"2025-10-07T12:21:35.376Z","level":"DEBUG","category":"PRE_VALIDATION","message":"Making first HTTP request to validate pre-order","file":"service.go","line":249}
{"timestamp":"2025-10-07T12:21:35.376Z","level":"DEBUG","category":"PRE_VALIDATION","message":"Pre-validation URL: http://localhost:8082/api/event-query/internal/v1/validate-pre-order","file":"service.go","line":264}
{"timestamp":"2025-10-07T12:21:35.377Z","level":"DEBUG","category":"PRE_VALIDATION","message":"Request body: {\"session_id\":\"0e16aca6-92dd-4847-b952-31552963c335\",\"event_id\":\"79955f7b-3735-4dce-a112-ba0ef29d36bd\",\"seat_ids\":[\"628324d0-1efc-4dbb-a2f0-86b23283415a\"],\"discount_id\":\"\"}","file":"service.go","line":265}
{"timestamp":"2025-10-07T12:21:35.404Z","level":"ERROR","category":"PRE_VALIDATION","message":"Pre-validation failed: status 400","file":"service.go","line":291}
{"timestamp":"2025-10-07T12:21:35.404Z","level":"ERROR","category":"API","message":"SeatValidationAndPlaceOrder: seat validation failed: pre-validation failed: status 400","file":"handler.go","line":271}
{"timestamp":"2025-10-07T12:22:53.597Z","level":"INFO","category":"APP","message":"Shutdown signal received, initiating graceful shutdown","file":"main.go","line":316}
{"timestamp":"2025-10-07T12:22:53.598Z","level":"INFO","category":"HTTP","message":"âœ… Order Service shutdown complete","file":"main.go","line":323}
{"timestamp":"2025-10-07T12:22:53.598Z","level":"INFO","category":"DATABASE","message":"Redis connection closed","file":"main.go","line":208}
{"timestamp":"2025-10-07T12:22:53.598Z","level":"INFO","category":"DATABASE","message":"PostgreSQL connection closed","file":"main.go","line":204}
{"timestamp":"2025-10-07T12:22:53.598Z","level":"INFO","category":"LOGGER","message":"Closing log file","file":"logger.go","line":216}
{"timestamp":"2025-10-07T12:22:57.144Z","level":"INFO","category":"LOGGER","message":"Enhanced logging system initialized","file":"logger.go","line":68}
{"timestamp":"2025-10-07T12:22:57.144Z","level":"INFO","category":"LOGGER","message":"Log file: logs/order-gateway-2025-10-07.log","file":"logger.go","line":69}
{"timestamp":"2025-10-07T12:22:57.144Z","level":"INFO","category":"APP","message":"Starting Order Service initialization","file":"main.go","line":185}
{"timestamp":"2025-10-07T12:22:57.144Z","level":"INFO","category":"CONFIG","message":"Loaded environment variables from .env file","file":"main.go","line":191}
{"timestamp":"2025-10-07T12:22:57.144Z","level":"INFO","category":"APP","message":"Verifying database connections","file":"main.go","line":199}
{"timestamp":"2025-10-07T12:22:57.144Z","level":"INFO","category":"DATABASE","message":"Attempting to connect to PostgreSQL (attempt 1/5)","file":"main.go","line":121}
{"timestamp":"2025-10-07T12:22:57.152Z","level":"INFO","category":"DATABASE","message":"âœ… PostgreSQL connection successful","file":"main.go","line":145}
{"timestamp":"2025-10-07T12:22:57.154Z","level":"INFO","category":"REDIS","message":"Keyspace notifications enabled for expired events","file":"main.go","line":166}
{"timestamp":"2025-10-07T12:22:57.154Z","level":"INFO","category":"DATABASE","message":"âœ… Redis connection successful to localhost:6379 (DB: 0)","file":"main.go","line":168}
{"timestamp":"2025-10-07T12:22:57.154Z","level":"INFO","category":"KAFKA","message":"Initializing Kafka producer","file":"main.go","line":211}
{"timestamp":"2025-10-07T12:22:57.154Z","level":"INFO","category":"KAFKA","message":"Using Kafka address from environment variable: localhost:9092","file":"main.go","line":214}
{"timestamp":"2025-10-07T12:22:57.154Z","level":"INFO","category":"KAFKA","message":"Kafka brokers configured: [localhost:9092]","file":"main.go","line":216}
{"timestamp":"2025-10-07T12:22:57.154Z","level":"INFO","category":"KAFKA","message":"Kafka producer initialized successfully","file":"main.go","line":218}
{"timestamp":"2025-10-07T12:22:57.154Z","level":"INFO","category":"KAFKA","message":"Ensuring required topics exist","file":"main.go","line":221}
{"timestamp":"2025-10-07T12:22:58.171Z","level":"INFO","category":"KAFKA","message":"Required topics ensured successfully","file":"main.go","line":234}
{"timestamp":"2025-10-07T12:22:58.172Z","level":"INFO","category":"SERVICE","message":"Initializing ticket service","file":"main.go","line":237}
{"timestamp":"2025-10-07T12:22:58.172Z","level":"INFO","category":"SERVICE","message":"Initializing order service","file":"main.go","line":240}
{"timestamp":"2025-10-07T12:22:58.172Z","level":"INFO","category":"LOGGER","message":"Enhanced logging system initialized","file":"logger.go","line":68}
{"timestamp":"2025-10-07T12:22:58.172Z","level":"INFO","category":"LOGGER","message":"Log file: logs/order-gateway-2025-10-07.log","file":"logger.go","line":69}
{"timestamp":"2025-10-07T12:22:58.175Z","level":"INFO","category":"LOGGER","message":"Enhanced logging system initialized","file":"logger.go","line":68}
{"timestamp":"2025-10-07T12:22:58.175Z","level":"INFO","category":"LOGGER","message":"Log file: logs/order-gateway-2025-10-07.log","file":"logger.go","line":69}
{"timestamp":"2025-10-07T12:22:58.175Z","level":"INFO","category":"HTTP","message":"Setting up router and middleware","file":"main.go","line":259}
{"timestamp":"2025-10-07T12:22:58.180Z","level":"INFO","category":"AUTH","message":"JWT middleware applied globally","file":"main.go","line":265}
{"timestamp":"2025-10-07T12:22:58.180Z","level":"INFO","category":"ROUTER","message":"Order routes registered under /api/order","file":"main.go","line":279}
{"timestamp":"2025-10-07T12:22:58.180Z","level":"INFO","category":"ROUTER","message":"Ticket routes registered under /api/order/ticket","file":"main.go","line":289}
{"timestamp":"2025-10-07T12:22:58.180Z","level":"INFO","category":"REDIS","message":"Starting seat unlock subscription","file":"main.go","line":299}
{"timestamp":"2025-10-07T12:22:58.180Z","level":"INFO","category":"REDIS","message":"Current keyspace notifications setting: [notify-keyspace-events xE]","file":"main.go","line":48}
{"timestamp":"2025-10-07T12:22:58.181Z","level":"INFO","category":"REDIS","message":"Subscribed to Redis keyevent expired notifications (DB 0)","file":"main.go","line":55}
{"timestamp":"2025-10-07T12:22:58.181Z","level":"INFO","category":"HTTP","message":"ðŸš€ Order Service running on :8084","file":"main.go","line":304}
{"timestamp":"2025-10-07T12:22:58.181Z","level":"INFO","category":"APP","message":"Service started successfully, waiting for shutdown signal","file":"main.go","line":313}
{"timestamp":"2025-10-07T12:23:01.322Z","level":"INFO","category":"API","message":"SeatValidationAndPlaceOrder: received request","file":"handler.go","line":254}
{"timestamp":"2025-10-07T12:23:01.322Z","level":"DEBUG","category":"API","message":"SeatValidationAndPlaceOrder: SessionID: 0e16aca6-92dd-4847-b952-31552963c335","file":"handler.go","line":265}
{"timestamp":"2025-10-07T12:23:01.322Z","level":"DEBUG","category":"API","message":"SeatValidationAndPlaceOrder: SeatIDs: [628324d0-1efc-4dbb-a2f0-86b23283415a]","file":"handler.go","line":266}
{"timestamp":"2025-10-07T12:23:01.322Z","level":"INFO","category":"ORDER","message":"Starting seat validation and order placement process","file":"service.go","line":214}
{"timestamp":"2025-10-07T12:23:01.322Z","level":"DEBUG","category":"ORDER","message":"Order request: {SessionID:0e16aca6-92dd-4847-b952-31552963c335 EventID:79955f7b-3735-4dce-a112-ba0ef29d36bd SeatIDs:[628324d0-1efc-4dbb-a2f0-86b23283415a] DiscountID:}","file":"service.go","line":229}
{"timestamp":"2025-10-07T12:23:01.322Z","level":"DEBUG","category":"AUTH","message":"Requesting M2M token for seat validation","file":"service.go","line":237}
{"timestamp":"2025-10-07T12:23:01.327Z","level":"DEBUG","category":"ORDER","message":"Generated order ID: 406ab18f-b5dc-49ff-9309-c462e2656334","file":"service.go","line":246}
{"timestamp":"2025-10-07T12:23:01.328Z","level":"DEBUG","category":"PRE_VALIDATION","message":"Making first HTTP request to validate pre-order","file":"service.go","line":249}
{"timestamp":"2025-10-07T12:23:01.328Z","level":"DEBUG","category":"PRE_VALIDATION","message":"Pre-validation URL: http://localhost:8082/api/event-query/internal/v1/validate-pre-order","file":"service.go","line":264}
{"timestamp":"2025-10-07T12:23:01.329Z","level":"DEBUG","category":"PRE_VALIDATION","message":"Request body: {\"session_id\":\"0e16aca6-92dd-4847-b952-31552963c335\",\"event_id\":\"79955f7b-3735-4dce-a112-ba0ef29d36bd\",\"seat_ids\":[\"628324d0-1efc-4dbb-a2f0-86b23283415a\"],\"discount_id\":\"\"}","file":"service.go","line":265}
{"timestamp":"2025-10-07T12:23:01.349Z","level":"ERROR","category":"PRE_VALIDATION","message":"Pre-validation failed: status 400","file":"service.go","line":291}
{"timestamp":"2025-10-07T12:23:01.349Z","level":"ERROR","category":"API","message":"SeatValidationAndPlaceOrder: seat validation failed: pre-validation failed: status 400","file":"handler.go","line":271}
{"timestamp":"2025-10-07T12:38:56.100Z","level":"INFO","category":"API","message":"SeatValidationAndPlaceOrder: received request","file":"handler.go","line":254}
{"timestamp":"2025-10-07T12:38:56.100Z","level":"DEBUG","category":"API","message":"SeatValidationAndPlaceOrder: SessionID: 0e16aca6-92dd-4847-b952-31552963c335","file":"handler.go","line":265}
{"timestamp":"2025-10-07T12:38:56.100Z","level":"DEBUG","category":"API","message":"SeatValidationAndPlaceOrder: SeatIDs: [628324d0-1efc-4dbb-a2f0-86b23283415a]","file":"handler.go","line":266}
{"timestamp":"2025-10-07T12:38:56.100Z","level":"INFO","category":"ORDER","message":"Starting seat validation and order placement process","file":"service.go","line":214}
{"timestamp":"2025-10-07T12:38:56.101Z","level":"DEBUG","category":"ORDER","message":"Order request: {SessionID:0e16aca6-92dd-4847-b952-31552963c335 EventID:79955f7b-3735-4dce-a112-ba0ef29d36bd SeatIDs:[628324d0-1efc-4dbb-a2f0-86b23283415a] DiscountID:}","file":"service.go","line":229}
{"timestamp":"2025-10-07T12:38:56.101Z","level":"DEBUG","category":"AUTH","message":"Requesting M2M token for seat validation","file":"service.go","line":237}
{"timestamp":"2025-10-07T12:38:56.116Z","level":"DEBUG","category":"ORDER","message":"Generated order ID: 10385a13-08d6-454c-a40e-bbf62969fa7a","file":"service.go","line":246}
{"timestamp":"2025-10-07T12:38:56.116Z","level":"DEBUG","category":"PRE_VALIDATION","message":"Making first HTTP request to validate pre-order","file":"service.go","line":249}
{"timestamp":"2025-10-07T12:38:56.116Z","level":"DEBUG","category":"PRE_VALIDATION","message":"Pre-validation URL: http://localhost:8082/api/event-query/internal/v1/validate-pre-order","file":"service.go","line":264}
{"timestamp":"2025-10-07T12:38:56.116Z","level":"DEBUG","category":"PRE_VALIDATION","message":"Request body: {\"session_id\":\"0e16aca6-92dd-4847-b952-31552963c335\",\"event_id\":\"79955f7b-3735-4dce-a112-ba0ef29d36bd\",\"seat_ids\":[\"628324d0-1efc-4dbb-a2f0-86b23283415a\"],\"discount_id\":\"\"}","file":"service.go","line":265}
{"timestamp":"2025-10-07T12:38:56.141Z","level":"INFO","category":"PRE_VALIDATION","message":"Pre-validation successful, OrderDetailsDTO received","file":"service.go","line":295}
{"timestamp":"2025-10-07T12:38:56.141Z","level":"DEBUG","category":"REDIS","message":"Attempting to lock seats in Redis","file":"service.go","line":298}
{"timestamp":"2025-10-07T12:38:58.189Z","level":"INFO","category":"REDIS","message":"Seats locked successfully","file":"service.go","line":308}
{"timestamp":"2025-10-07T12:38:58.189Z","level":"DEBUG","category":"SEAT_VALIDATION","message":"Making second HTTP request to validate seats after locking","file":"service.go","line":317}
{"timestamp":"2025-10-07T12:38:58.205Z","level":"INFO","category":"SEAT_VALIDATION","message":"Final seat validation successful","file":"service.go","line":353}
{"timestamp":"2025-10-07T12:38:59.210Z","level":"INFO","category":"KAFKA","message":"Published seats locked event for 1 seats","file":"service.go","line":531}
{"timestamp":"2025-10-07T12:38:59.210Z","level":"INFO","category":"ORDER","message":"Placing order: 10385a13-08d6-454c-a40e-bbf62969fa7a for session: 0e16aca6-92dd-4847-b952-31552963c335","file":"service.go","line":72}
{"timestamp":"2025-10-07T12:38:59.210Z","level":"DEBUG","category":"ORDER","message":"Skipping seat locking as seats are already locked","file":"service.go","line":87}
{"timestamp":"2025-10-07T12:38:59.210Z","level":"DEBUG","category":"ORDER","message":"Creating order in DB...","file":"service.go","line":90}
{"timestamp":"2025-10-07T12:38:59.214Z","level":"ERROR","category":"ORDER","message":"Failed to create order: pq: invalid input syntax for type uuid: \"\". Rolling back seat locks.","file":"service.go","line":92}
{"timestamp":"2025-10-07T12:39:01.223Z","level":"ERROR","category":"ORDER","message":"Failed to place order: pq: invalid input syntax for type uuid: \"\". Unlocking seats.","file":"service.go","line":424}
{"timestamp":"2025-10-07T12:39:01.224Z","level":"WARN","category":"TXN","message":"Rolling back: unlocking seats","file":"service.go","line":312}
{"timestamp":"2025-10-07T12:39:01.225Z","level":"ERROR","category":"API","message":"SeatValidationAndPlaceOrder: seat validation failed: failed to place order: pq: invalid input syntax for type uuid: \"\"","file":"handler.go","line":271}
{"timestamp":"2025-10-07T12:39:23.018Z","level":"INFO","category":"APP","message":"Shutdown signal received, initiating graceful shutdown","file":"main.go","line":316}
{"timestamp":"2025-10-07T12:39:23.018Z","level":"INFO","category":"HTTP","message":"âœ… Order Service shutdown complete","file":"main.go","line":323}
{"timestamp":"2025-10-07T12:39:23.019Z","level":"INFO","category":"DATABASE","message":"Redis connection closed","file":"main.go","line":208}
{"timestamp":"2025-10-07T12:39:23.019Z","level":"INFO","category":"DATABASE","message":"PostgreSQL connection closed","file":"main.go","line":204}
{"timestamp":"2025-10-07T12:39:23.019Z","level":"INFO","category":"LOGGER","message":"Closing log file","file":"logger.go","line":216}
{"timestamp":"2025-10-07T12:39:24.672Z","level":"INFO","category":"LOGGER","message":"Enhanced logging system initialized","file":"logger.go","line":68}
{"timestamp":"2025-10-07T12:39:24.672Z","level":"INFO","category":"LOGGER","message":"Log file: logs/order-gateway-2025-10-07.log","file":"logger.go","line":69}
{"timestamp":"2025-10-07T12:39:24.672Z","level":"INFO","category":"APP","message":"Starting Order Service initialization","file":"main.go","line":185}
{"timestamp":"2025-10-07T12:39:24.672Z","level":"INFO","category":"CONFIG","message":"Loaded environment variables from .env file","file":"main.go","line":191}
{"timestamp":"2025-10-07T12:39:24.672Z","level":"INFO","category":"APP","message":"Verifying database connections","file":"main.go","line":199}
{"timestamp":"2025-10-07T12:39:24.672Z","level":"INFO","category":"DATABASE","message":"Attempting to connect to PostgreSQL (attempt 1/5)","file":"main.go","line":121}
{"timestamp":"2025-10-07T12:39:24.683Z","level":"INFO","category":"DATABASE","message":"âœ… PostgreSQL connection successful","file":"main.go","line":145}
{"timestamp":"2025-10-07T12:39:24.687Z","level":"INFO","category":"REDIS","message":"Keyspace notifications enabled for expired events","file":"main.go","line":166}
{"timestamp":"2025-10-07T12:39:24.687Z","level":"INFO","category":"DATABASE","message":"âœ… Redis connection successful to localhost:6379 (DB: 0)","file":"main.go","line":168}
{"timestamp":"2025-10-07T12:39:24.687Z","level":"INFO","category":"KAFKA","message":"Initializing Kafka producer","file":"main.go","line":211}
{"timestamp":"2025-10-07T12:39:24.687Z","level":"INFO","category":"KAFKA","message":"Using Kafka address from environment variable: localhost:9092","file":"main.go","line":214}
{"timestamp":"2025-10-07T12:39:24.687Z","level":"INFO","category":"KAFKA","message":"Kafka brokers configured: [localhost:9092]","file":"main.go","line":216}
{"timestamp":"2025-10-07T12:39:24.687Z","level":"INFO","category":"KAFKA","message":"Kafka producer initialized successfully","file":"main.go","line":218}
{"timestamp":"2025-10-07T12:39:24.687Z","level":"INFO","category":"KAFKA","message":"Ensuring required topics exist","file":"main.go","line":221}
{"timestamp":"2025-10-07T12:39:25.698Z","level":"INFO","category":"KAFKA","message":"Required topics ensured successfully","file":"main.go","line":234}
{"timestamp":"2025-10-07T12:39:25.698Z","level":"INFO","category":"SERVICE","message":"Initializing ticket service","file":"main.go","line":237}
{"timestamp":"2025-10-07T12:39:25.698Z","level":"INFO","category":"SERVICE","message":"Initializing order service","file":"main.go","line":240}
{"timestamp":"2025-10-07T12:39:25.698Z","level":"INFO","category":"LOGGER","message":"Enhanced logging system initialized","file":"logger.go","line":68}
{"timestamp":"2025-10-07T12:39:25.698Z","level":"INFO","category":"LOGGER","message":"Log file: logs/order-gateway-2025-10-07.log","file":"logger.go","line":69}
{"timestamp":"2025-10-07T12:39:25.698Z","level":"INFO","category":"LOGGER","message":"Enhanced logging system initialized","file":"logger.go","line":68}
{"timestamp":"2025-10-07T12:39:25.698Z","level":"INFO","category":"LOGGER","message":"Log file: logs/order-gateway-2025-10-07.log","file":"logger.go","line":69}
{"timestamp":"2025-10-07T12:39:25.698Z","level":"INFO","category":"HTTP","message":"Setting up router and middleware","file":"main.go","line":259}
{"timestamp":"2025-10-07T12:39:25.705Z","level":"INFO","category":"AUTH","message":"JWT middleware applied globally","file":"main.go","line":265}
{"timestamp":"2025-10-07T12:39:25.705Z","level":"INFO","category":"ROUTER","message":"Order routes registered under /api/order","file":"main.go","line":279}
{"timestamp":"2025-10-07T12:39:25.705Z","level":"INFO","category":"ROUTER","message":"Ticket routes registered under /api/order/ticket","file":"main.go","line":289}
{"timestamp":"2025-10-07T12:39:25.705Z","level":"INFO","category":"REDIS","message":"Starting seat unlock subscription","file":"main.go","line":299}
{"timestamp":"2025-10-07T12:39:25.705Z","level":"INFO","category":"REDIS","message":"Current keyspace notifications setting: [notify-keyspace-events xE]","file":"main.go","line":48}
{"timestamp":"2025-10-07T12:39:25.706Z","level":"INFO","category":"REDIS","message":"Subscribed to Redis keyevent expired notifications (DB 0)","file":"main.go","line":55}
{"timestamp":"2025-10-07T12:39:25.706Z","level":"INFO","category":"HTTP","message":"ðŸš€ Order Service running on :8084","file":"main.go","line":304}
{"timestamp":"2025-10-07T12:39:25.706Z","level":"INFO","category":"APP","message":"Service started successfully, waiting for shutdown signal","file":"main.go","line":313}
{"timestamp":"2025-10-07T12:39:28.094Z","level":"INFO","category":"API","message":"SeatValidationAndPlaceOrder: received request","file":"handler.go","line":254}
{"timestamp":"2025-10-07T12:39:28.094Z","level":"DEBUG","category":"API","message":"SeatValidationAndPlaceOrder: SessionID: 0e16aca6-92dd-4847-b952-31552963c335","file":"handler.go","line":265}
{"timestamp":"2025-10-07T12:39:28.094Z","level":"DEBUG","category":"API","message":"SeatValidationAndPlaceOrder: SeatIDs: [628324d0-1efc-4dbb-a2f0-86b23283415a]","file":"handler.go","line":266}
{"timestamp":"2025-10-07T12:39:28.094Z","level":"INFO","category":"ORDER","message":"Starting seat validation and order placement process","file":"service.go","line":214}
{"timestamp":"2025-10-07T12:39:28.094Z","level":"DEBUG","category":"ORDER","message":"Order request: {SessionID:0e16aca6-92dd-4847-b952-31552963c335 EventID:79955f7b-3735-4dce-a112-ba0ef29d36bd SeatIDs:[628324d0-1efc-4dbb-a2f0-86b23283415a] DiscountID:}","file":"service.go","line":229}
{"timestamp":"2025-10-07T12:39:28.094Z","level":"DEBUG","category":"AUTH","message":"Requesting M2M token for seat validation","file":"service.go","line":237}
{"timestamp":"2025-10-07T12:39:28.101Z","level":"DEBUG","category":"ORDER","message":"Generated order ID: c96591b1-afc8-42ba-a4b8-1fd20dfbd1dc","file":"service.go","line":246}
{"timestamp":"2025-10-07T12:39:28.102Z","level":"DEBUG","category":"PRE_VALIDATION","message":"Making first HTTP request to validate pre-order","file":"service.go","line":249}
{"timestamp":"2025-10-07T12:39:28.102Z","level":"DEBUG","category":"PRE_VALIDATION","message":"Pre-validation URL: http://localhost:8082/api/event-query/internal/v1/validate-pre-order","file":"service.go","line":264}
{"timestamp":"2025-10-07T12:39:28.102Z","level":"DEBUG","category":"PRE_VALIDATION","message":"Request body: {\"session_id\":\"0e16aca6-92dd-4847-b952-31552963c335\",\"event_id\":\"79955f7b-3735-4dce-a112-ba0ef29d36bd\",\"seat_ids\":[\"628324d0-1efc-4dbb-a2f0-86b23283415a\"],\"discount_id\":\"\"}","file":"service.go","line":265}
{"timestamp":"2025-10-07T12:39:28.180Z","level":"ERROR","category":"PRE_VALIDATION","message":"Pre-validation failed: status 400","file":"service.go","line":291}
{"timestamp":"2025-10-07T12:39:28.180Z","level":"ERROR","category":"API","message":"SeatValidationAndPlaceOrder: seat validation failed: pre-validation failed: status 400","file":"handler.go","line":271}
{"timestamp":"2025-10-07T12:39:37.819Z","level":"INFO","category":"APP","message":"Shutdown signal received, initiating graceful shutdown","file":"main.go","line":316}
{"timestamp":"2025-10-07T12:39:37.819Z","level":"INFO","category":"HTTP","message":"âœ… Order Service shutdown complete","file":"main.go","line":323}
{"timestamp":"2025-10-07T12:39:37.819Z","level":"INFO","category":"DATABASE","message":"Redis connection closed","file":"main.go","line":208}
{"timestamp":"2025-10-07T12:39:37.819Z","level":"INFO","category":"DATABASE","message":"PostgreSQL connection closed","file":"main.go","line":204}
{"timestamp":"2025-10-07T12:39:37.819Z","level":"INFO","category":"LOGGER","message":"Closing log file","file":"logger.go","line":216}
{"timestamp":"2025-10-07T12:39:39.950Z","level":"INFO","category":"LOGGER","message":"Enhanced logging system initialized","file":"logger.go","line":68}
{"timestamp":"2025-10-07T12:39:39.950Z","level":"INFO","category":"LOGGER","message":"Log file: logs/order-gateway-2025-10-07.log","file":"logger.go","line":69}
{"timestamp":"2025-10-07T12:39:39.950Z","level":"INFO","category":"APP","message":"Starting Order Service initialization","file":"main.go","line":185}
{"timestamp":"2025-10-07T12:39:39.950Z","level":"INFO","category":"CONFIG","message":"Loaded environment variables from .env file","file":"main.go","line":191}
{"timestamp":"2025-10-07T12:39:39.950Z","level":"INFO","category":"APP","message":"Verifying database connections","file":"main.go","line":199}
{"timestamp":"2025-10-07T12:39:39.950Z","level":"INFO","category":"DATABASE","message":"Attempting to connect to PostgreSQL (attempt 1/5)","file":"main.go","line":121}
{"timestamp":"2025-10-07T12:39:39.955Z","level":"INFO","category":"DATABASE","message":"âœ… PostgreSQL connection successful","file":"main.go","line":145}
{"timestamp":"2025-10-07T12:39:39.956Z","level":"INFO","category":"REDIS","message":"Keyspace notifications enabled for expired events","file":"main.go","line":166}
{"timestamp":"2025-10-07T12:39:39.956Z","level":"INFO","category":"DATABASE","message":"âœ… Redis connection successful to localhost:6379 (DB: 0)","file":"main.go","line":168}
{"timestamp":"2025-10-07T12:39:39.956Z","level":"INFO","category":"KAFKA","message":"Initializing Kafka producer","file":"main.go","line":211}
{"timestamp":"2025-10-07T12:39:39.956Z","level":"INFO","category":"KAFKA","message":"Using Kafka address from environment variable: localhost:9092","file":"main.go","line":214}
{"timestamp":"2025-10-07T12:39:39.956Z","level":"INFO","category":"KAFKA","message":"Kafka brokers configured: [localhost:9092]","file":"main.go","line":216}
{"timestamp":"2025-10-07T12:39:39.956Z","level":"INFO","category":"KAFKA","message":"Kafka producer initialized successfully","file":"main.go","line":218}
{"timestamp":"2025-10-07T12:39:39.956Z","level":"INFO","category":"KAFKA","message":"Ensuring required topics exist","file":"main.go","line":221}
{"timestamp":"2025-10-07T12:39:40.962Z","level":"INFO","category":"KAFKA","message":"Required topics ensured successfully","file":"main.go","line":234}
{"timestamp":"2025-10-07T12:39:40.962Z","level":"INFO","category":"SERVICE","message":"Initializing ticket service","file":"main.go","line":237}
{"timestamp":"2025-10-07T12:39:40.962Z","level":"INFO","category":"SERVICE","message":"Initializing order service","file":"main.go","line":240}
{"timestamp":"2025-10-07T12:39:40.962Z","level":"INFO","category":"LOGGER","message":"Enhanced logging system initialized","file":"logger.go","line":68}
{"timestamp":"2025-10-07T12:39:40.962Z","level":"INFO","category":"LOGGER","message":"Log file: logs/order-gateway-2025-10-07.log","file":"logger.go","line":69}
{"timestamp":"2025-10-07T12:39:40.962Z","level":"INFO","category":"LOGGER","message":"Enhanced logging system initialized","file":"logger.go","line":68}
{"timestamp":"2025-10-07T12:39:40.962Z","level":"INFO","category":"LOGGER","message":"Log file: logs/order-gateway-2025-10-07.log","file":"logger.go","line":69}
{"timestamp":"2025-10-07T12:39:40.966Z","level":"INFO","category":"HTTP","message":"Setting up router and middleware","file":"main.go","line":259}
{"timestamp":"2025-10-07T12:39:40.974Z","level":"INFO","category":"AUTH","message":"JWT middleware applied globally","file":"main.go","line":265}
{"timestamp":"2025-10-07T12:39:40.974Z","level":"INFO","category":"ROUTER","message":"Order routes registered under /api/order","file":"main.go","line":279}
{"timestamp":"2025-10-07T12:39:40.974Z","level":"INFO","category":"ROUTER","message":"Ticket routes registered under /api/order/ticket","file":"main.go","line":289}
{"timestamp":"2025-10-07T12:39:40.974Z","level":"INFO","category":"REDIS","message":"Starting seat unlock subscription","file":"main.go","line":299}
{"timestamp":"2025-10-07T12:39:40.975Z","level":"INFO","category":"REDIS","message":"Current keyspace notifications setting: [notify-keyspace-events xE]","file":"main.go","line":48}
{"timestamp":"2025-10-07T12:39:40.975Z","level":"INFO","category":"REDIS","message":"Subscribed to Redis keyevent expired notifications (DB 0)","file":"main.go","line":55}
{"timestamp":"2025-10-07T12:39:40.976Z","level":"INFO","category":"HTTP","message":"ðŸš€ Order Service running on :8084","file":"main.go","line":304}
{"timestamp":"2025-10-07T12:39:40.976Z","level":"INFO","category":"APP","message":"Service started successfully, waiting for shutdown signal","file":"main.go","line":313}
{"timestamp":"2025-10-07T12:39:41.884Z","level":"INFO","category":"API","message":"SeatValidationAndPlaceOrder: received request","file":"handler.go","line":254}
{"timestamp":"2025-10-07T12:39:41.884Z","level":"DEBUG","category":"API","message":"SeatValidationAndPlaceOrder: SessionID: 0e16aca6-92dd-4847-b952-31552963c335","file":"handler.go","line":265}
{"timestamp":"2025-10-07T12:39:41.884Z","level":"DEBUG","category":"API","message":"SeatValidationAndPlaceOrder: SeatIDs: [628324d0-1efc-4dbb-a2f0-86b23283415a]","file":"handler.go","line":266}
{"timestamp":"2025-10-07T12:39:41.884Z","level":"INFO","category":"ORDER","message":"Starting seat validation and order placement process","file":"service.go","line":214}
{"timestamp":"2025-10-07T12:39:41.884Z","level":"DEBUG","category":"ORDER","message":"Order request: {SessionID:0e16aca6-92dd-4847-b952-31552963c335 EventID:79955f7b-3735-4dce-a112-ba0ef29d36bd SeatIDs:[628324d0-1efc-4dbb-a2f0-86b23283415a] DiscountID:}","file":"service.go","line":229}
{"timestamp":"2025-10-07T12:39:41.884Z","level":"DEBUG","category":"AUTH","message":"Requesting M2M token for seat validation","file":"service.go","line":237}
{"timestamp":"2025-10-07T12:39:41.892Z","level":"DEBUG","category":"ORDER","message":"Generated order ID: f2ecbff3-c2a6-4199-98ca-36bd4ac40209","file":"service.go","line":246}
{"timestamp":"2025-10-07T12:39:41.892Z","level":"DEBUG","category":"PRE_VALIDATION","message":"Making first HTTP request to validate pre-order","file":"service.go","line":249}
{"timestamp":"2025-10-07T12:39:41.892Z","level":"DEBUG","category":"PRE_VALIDATION","message":"Pre-validation URL: http://localhost:8082/api/event-query/internal/v1/validate-pre-order","file":"service.go","line":264}
{"timestamp":"2025-10-07T12:39:41.892Z","level":"DEBUG","category":"PRE_VALIDATION","message":"Request body: {\"session_id\":\"0e16aca6-92dd-4847-b952-31552963c335\",\"event_id\":\"79955f7b-3735-4dce-a112-ba0ef29d36bd\",\"seat_ids\":[\"628324d0-1efc-4dbb-a2f0-86b23283415a\"],\"discount_id\":\"\"}","file":"service.go","line":265}
{"timestamp":"2025-10-07T12:39:41.921Z","level":"ERROR","category":"PRE_VALIDATION","message":"Pre-validation failed: status 400","file":"service.go","line":291}
{"timestamp":"2025-10-07T12:39:41.921Z","level":"ERROR","category":"API","message":"SeatValidationAndPlaceOrder: seat validation failed: pre-validation failed: status 400","file":"handler.go","line":271}
{"timestamp":"2025-10-07T12:40:20.428Z","level":"INFO","category":"API","message":"SeatValidationAndPlaceOrder: received request","file":"handler.go","line":254}
{"timestamp":"2025-10-07T12:40:20.428Z","level":"DEBUG","category":"API","message":"SeatValidationAndPlaceOrder: SessionID: 0e16aca6-92dd-4847-b952-31552963c335","file":"handler.go","line":265}
{"timestamp":"2025-10-07T12:40:20.428Z","level":"DEBUG","category":"API","message":"SeatValidationAndPlaceOrder: SeatIDs: [1438ec58-d9f7-4ed5-b9cf-38867f0a2ad8]","file":"handler.go","line":266}
{"timestamp":"2025-10-07T12:40:20.429Z","level":"INFO","category":"ORDER","message":"Starting seat validation and order placement process","file":"service.go","line":214}
{"timestamp":"2025-10-07T12:40:20.429Z","level":"DEBUG","category":"ORDER","message":"Order request: {SessionID:0e16aca6-92dd-4847-b952-31552963c335 EventID:79955f7b-3735-4dce-a112-ba0ef29d36bd SeatIDs:[1438ec58-d9f7-4ed5-b9cf-38867f0a2ad8] DiscountID:}","file":"service.go","line":229}
{"timestamp":"2025-10-07T12:40:20.429Z","level":"DEBUG","category":"AUTH","message":"Requesting M2M token for seat validation","file":"service.go","line":237}
{"timestamp":"2025-10-07T12:40:20.436Z","level":"DEBUG","category":"ORDER","message":"Generated order ID: ddc65666-25ec-472a-b209-fafa8ec41f7c","file":"service.go","line":246}
{"timestamp":"2025-10-07T12:40:20.436Z","level":"DEBUG","category":"PRE_VALIDATION","message":"Making first HTTP request to validate pre-order","file":"service.go","line":249}
{"timestamp":"2025-10-07T12:40:20.436Z","level":"DEBUG","category":"PRE_VALIDATION","message":"Pre-validation URL: http://localhost:8082/api/event-query/internal/v1/validate-pre-order","file":"service.go","line":264}
{"timestamp":"2025-10-07T12:40:20.436Z","level":"DEBUG","category":"PRE_VALIDATION","message":"Request body: {\"session_id\":\"0e16aca6-92dd-4847-b952-31552963c335\",\"event_id\":\"79955f7b-3735-4dce-a112-ba0ef29d36bd\",\"seat_ids\":[\"1438ec58-d9f7-4ed5-b9cf-38867f0a2ad8\"],\"discount_id\":\"\"}","file":"service.go","line":265}
{"timestamp":"2025-10-07T12:40:20.455Z","level":"INFO","category":"PRE_VALIDATION","message":"Pre-validation successful, OrderDetailsDTO received","file":"service.go","line":295}
{"timestamp":"2025-10-07T12:40:20.455Z","level":"DEBUG","category":"REDIS","message":"Attempting to lock seats in Redis","file":"service.go","line":298}
{"timestamp":"2025-10-07T12:40:22.467Z","level":"INFO","category":"REDIS","message":"Seats locked successfully","file":"service.go","line":308}
{"timestamp":"2025-10-07T12:40:22.467Z","level":"DEBUG","category":"SEAT_VALIDATION","message":"Making second HTTP request to validate seats after locking","file":"service.go","line":317}
{"timestamp":"2025-10-07T12:40:22.544Z","level":"INFO","category":"SEAT_VALIDATION","message":"Final seat validation successful","file":"service.go","line":353}
{"timestamp":"2025-10-07T12:40:23.552Z","level":"INFO","category":"KAFKA","message":"Published seats locked event for 1 seats","file":"service.go","line":531}
{"timestamp":"2025-10-07T12:40:23.552Z","level":"INFO","category":"ORDER","message":"Placing order: ddc65666-25ec-472a-b209-fafa8ec41f7c for session: 0e16aca6-92dd-4847-b952-31552963c335","file":"service.go","line":72}
{"timestamp":"2025-10-07T12:40:23.552Z","level":"DEBUG","category":"ORDER","message":"Skipping seat locking as seats are already locked","file":"service.go","line":87}
{"timestamp":"2025-10-07T12:40:23.552Z","level":"DEBUG","category":"ORDER","message":"Creating order in DB...","file":"service.go","line":90}
{"timestamp":"2025-10-07T12:40:23.554Z","level":"ERROR","category":"ORDER","message":"Failed to create order: pq: invalid input syntax for type uuid: \"\". Rolling back seat locks.","file":"service.go","line":92}
{"timestamp":"2025-10-07T12:40:25.562Z","level":"ERROR","category":"ORDER","message":"Failed to place order: pq: invalid input syntax for type uuid: \"\". Unlocking seats.","file":"service.go","line":424}
{"timestamp":"2025-10-07T12:40:25.562Z","level":"WARN","category":"TXN","message":"Rolling back: unlocking seats","file":"service.go","line":312}
{"timestamp":"2025-10-07T12:40:25.563Z","level":"ERROR","category":"API","message":"SeatValidationAndPlaceOrder: seat validation failed: failed to place order: pq: invalid input syntax for type uuid: \"\"","file":"handler.go","line":271}
{"timestamp":"2025-10-07T12:40:55.677Z","level":"INFO","category":"APP","message":"Shutdown signal received, initiating graceful shutdown","file":"main.go","line":316}
{"timestamp":"2025-10-07T12:40:55.677Z","level":"INFO","category":"HTTP","message":"âœ… Order Service shutdown complete","file":"main.go","line":323}
{"timestamp":"2025-10-07T12:40:55.677Z","level":"INFO","category":"DATABASE","message":"Redis connection closed","file":"main.go","line":208}
{"timestamp":"2025-10-07T12:40:55.677Z","level":"INFO","category":"DATABASE","message":"PostgreSQL connection closed","file":"main.go","line":204}
{"timestamp":"2025-10-07T12:40:55.677Z","level":"INFO","category":"LOGGER","message":"Closing log file","file":"logger.go","line":216}
{"timestamp":"2025-10-07T12:40:58.380Z","level":"INFO","category":"LOGGER","message":"Enhanced logging system initialized","file":"logger.go","line":68}
{"timestamp":"2025-10-07T12:40:58.380Z","level":"INFO","category":"LOGGER","message":"Log file: logs/order-gateway-2025-10-07.log","file":"logger.go","line":69}
{"timestamp":"2025-10-07T12:40:58.380Z","level":"INFO","category":"APP","message":"Starting Order Service initialization","file":"main.go","line":185}
{"timestamp":"2025-10-07T12:40:58.383Z","level":"INFO","category":"CONFIG","message":"Loaded environment variables from .env file","file":"main.go","line":191}
{"timestamp":"2025-10-07T12:40:58.383Z","level":"INFO","category":"APP","message":"Verifying database connections","file":"main.go","line":199}
{"timestamp":"2025-10-07T12:40:58.383Z","level":"INFO","category":"DATABASE","message":"Attempting to connect to PostgreSQL (attempt 1/5)","file":"main.go","line":121}
{"timestamp":"2025-10-07T12:40:58.388Z","level":"INFO","category":"DATABASE","message":"âœ… PostgreSQL connection successful","file":"main.go","line":145}
{"timestamp":"2025-10-07T12:40:58.389Z","level":"INFO","category":"REDIS","message":"Keyspace notifications enabled for expired events","file":"main.go","line":166}
{"timestamp":"2025-10-07T12:40:58.389Z","level":"INFO","category":"DATABASE","message":"âœ… Redis connection successful to localhost:6379 (DB: 0)","file":"main.go","line":168}
{"timestamp":"2025-10-07T12:40:58.389Z","level":"INFO","category":"KAFKA","message":"Initializing Kafka producer","file":"main.go","line":211}
{"timestamp":"2025-10-07T12:40:58.389Z","level":"INFO","category":"KAFKA","message":"Using Kafka address from environment variable: localhost:9092","file":"main.go","line":214}
{"timestamp":"2025-10-07T12:40:58.389Z","level":"INFO","category":"KAFKA","message":"Kafka brokers configured: [localhost:9092]","file":"main.go","line":216}
{"timestamp":"2025-10-07T12:40:58.389Z","level":"INFO","category":"KAFKA","message":"Kafka producer initialized successfully","file":"main.go","line":218}
{"timestamp":"2025-10-07T12:40:58.389Z","level":"INFO","category":"KAFKA","message":"Ensuring required topics exist","file":"main.go","line":221}
{"timestamp":"2025-10-07T12:40:59.396Z","level":"INFO","category":"KAFKA","message":"Required topics ensured successfully","file":"main.go","line":234}
{"timestamp":"2025-10-07T12:40:59.396Z","level":"INFO","category":"SERVICE","message":"Initializing ticket service","file":"main.go","line":237}
{"timestamp":"2025-10-07T12:40:59.396Z","level":"INFO","category":"SERVICE","message":"Initializing order service","file":"main.go","line":240}
{"timestamp":"2025-10-07T12:40:59.396Z","level":"INFO","category":"LOGGER","message":"Enhanced logging system initialized","file":"logger.go","line":68}
{"timestamp":"2025-10-07T12:40:59.396Z","level":"INFO","category":"LOGGER","message":"Log file: logs/order-gateway-2025-10-07.log","file":"logger.go","line":69}
{"timestamp":"2025-10-07T12:40:59.396Z","level":"INFO","category":"LOGGER","message":"Enhanced logging system initialized","file":"logger.go","line":68}
{"timestamp":"2025-10-07T12:40:59.396Z","level":"INFO","category":"LOGGER","message":"Log file: logs/order-gateway-2025-10-07.log","file":"logger.go","line":69}
{"timestamp":"2025-10-07T12:40:59.396Z","level":"INFO","category":"HTTP","message":"Setting up router and middleware","file":"main.go","line":259}
{"timestamp":"2025-10-07T12:40:59.405Z","level":"INFO","category":"AUTH","message":"JWT middleware applied globally","file":"main.go","line":265}
{"timestamp":"2025-10-07T12:40:59.405Z","level":"INFO","category":"ROUTER","message":"Order routes registered under /api/order","file":"main.go","line":279}
{"timestamp":"2025-10-07T12:40:59.406Z","level":"INFO","category":"ROUTER","message":"Ticket routes registered under /api/order/ticket","file":"main.go","line":289}
{"timestamp":"2025-10-07T12:40:59.406Z","level":"INFO","category":"REDIS","message":"Starting seat unlock subscription","file":"main.go","line":299}
{"timestamp":"2025-10-07T12:40:59.406Z","level":"INFO","category":"REDIS","message":"Current keyspace notifications setting: [notify-keyspace-events xE]","file":"main.go","line":48}
{"timestamp":"2025-10-07T12:40:59.407Z","level":"INFO","category":"REDIS","message":"Subscribed to Redis keyevent expired notifications (DB 0)","file":"main.go","line":55}
{"timestamp":"2025-10-07T12:40:59.407Z","level":"INFO","category":"HTTP","message":"ðŸš€ Order Service running on :8084","file":"main.go","line":304}
{"timestamp":"2025-10-07T12:40:59.408Z","level":"INFO","category":"APP","message":"Service started successfully, waiting for shutdown signal","file":"main.go","line":313}
{"timestamp":"2025-10-07T12:41:05.114Z","level":"INFO","category":"API","message":"SeatValidationAndPlaceOrder: received request","file":"handler.go","line":254}
{"timestamp":"2025-10-07T12:41:05.114Z","level":"DEBUG","category":"API","message":"SeatValidationAndPlaceOrder: SessionID: 0e16aca6-92dd-4847-b952-31552963c335","file":"handler.go","line":265}
{"timestamp":"2025-10-07T12:41:05.114Z","level":"DEBUG","category":"API","message":"SeatValidationAndPlaceOrder: SeatIDs: [80e6286c-15a0-4f0d-ab66-2ee03b236fac]","file":"handler.go","line":266}
{"timestamp":"2025-10-07T12:41:05.114Z","level":"INFO","category":"ORDER","message":"Starting seat validation and order placement process","file":"service.go","line":214}
{"timestamp":"2025-10-07T12:41:05.114Z","level":"DEBUG","category":"ORDER","message":"Order request: {SessionID:0e16aca6-92dd-4847-b952-31552963c335 EventID:79955f7b-3735-4dce-a112-ba0ef29d36bd SeatIDs:[80e6286c-15a0-4f0d-ab66-2ee03b236fac] DiscountID:}","file":"service.go","line":229}
{"timestamp":"2025-10-07T12:41:05.114Z","level":"DEBUG","category":"AUTH","message":"Requesting M2M token for seat validation","file":"service.go","line":237}
{"timestamp":"2025-10-07T12:41:05.130Z","level":"DEBUG","category":"ORDER","message":"Generated order ID: 9318cc34-e791-482f-a76f-f423470a2f6e","file":"service.go","line":246}
{"timestamp":"2025-10-07T12:41:05.130Z","level":"DEBUG","category":"PRE_VALIDATION","message":"Making first HTTP request to validate pre-order","file":"service.go","line":249}
{"timestamp":"2025-10-07T12:41:05.130Z","level":"DEBUG","category":"PRE_VALIDATION","message":"Pre-validation URL: http://localhost:8082/api/event-query/internal/v1/validate-pre-order","file":"service.go","line":264}
{"timestamp":"2025-10-07T12:41:05.130Z","level":"DEBUG","category":"PRE_VALIDATION","message":"Request body: {\"session_id\":\"0e16aca6-92dd-4847-b952-31552963c335\",\"event_id\":\"79955f7b-3735-4dce-a112-ba0ef29d36bd\",\"seat_ids\":[\"80e6286c-15a0-4f0d-ab66-2ee03b236fac\"],\"discount_id\":\"\"}","file":"service.go","line":265}
{"timestamp":"2025-10-07T12:41:05.148Z","level":"INFO","category":"PRE_VALIDATION","message":"Pre-validation successful, OrderDetailsDTO received","file":"service.go","line":295}
{"timestamp":"2025-10-07T12:41:05.148Z","level":"DEBUG","category":"REDIS","message":"Attempting to lock seats in Redis","file":"service.go","line":298}
{"timestamp":"2025-10-07T12:41:07.158Z","level":"INFO","category":"REDIS","message":"Seats locked successfully","file":"service.go","line":308}
{"timestamp":"2025-10-07T12:41:07.158Z","level":"DEBUG","category":"SEAT_VALIDATION","message":"Making second HTTP request to validate seats after locking","file":"service.go","line":317}
{"timestamp":"2025-10-07T12:41:07.176Z","level":"INFO","category":"SEAT_VALIDATION","message":"Final seat validation successful","file":"service.go","line":353}
{"timestamp":"2025-10-07T12:41:08.181Z","level":"INFO","category":"KAFKA","message":"Published seats locked event for 1 seats","file":"service.go","line":531}
{"timestamp":"2025-10-07T12:41:08.181Z","level":"INFO","category":"ORDER","message":"Placing order: 9318cc34-e791-482f-a76f-f423470a2f6e for session: 0e16aca6-92dd-4847-b952-31552963c335","file":"service.go","line":72}
{"timestamp":"2025-10-07T12:41:08.181Z","level":"DEBUG","category":"ORDER","message":"Skipping seat locking as seats are already locked","file":"service.go","line":87}
{"timestamp":"2025-10-07T12:41:08.181Z","level":"DEBUG","category":"ORDER","message":"Creating order in DB...","file":"service.go","line":90}
{"timestamp":"2025-10-07T12:41:08.182Z","level":"ERROR","category":"ORDER","message":"Failed to create order: pq: invalid input syntax for type uuid: \"\". Rolling back seat locks.","file":"service.go","line":92}
{"timestamp":"2025-10-07T12:41:10.189Z","level":"ERROR","category":"ORDER","message":"Failed to place order: pq: invalid input syntax for type uuid: \"\". Unlocking seats.","file":"service.go","line":424}
{"timestamp":"2025-10-07T12:41:10.189Z","level":"WARN","category":"TXN","message":"Rolling back: unlocking seats","file":"service.go","line":312}
{"timestamp":"2025-10-07T12:41:10.189Z","level":"ERROR","category":"API","message":"SeatValidationAndPlaceOrder: seat validation failed: failed to place order: pq: invalid input syntax for type uuid: \"\"","file":"handler.go","line":271}
{"timestamp":"2025-10-07T12:45:16.235Z","level":"INFO","category":"APP","message":"Shutdown signal received, initiating graceful shutdown","file":"main.go","line":316}
{"timestamp":"2025-10-07T12:45:16.238Z","level":"INFO","category":"HTTP","message":"âœ… Order Service shutdown complete","file":"main.go","line":323}
{"timestamp":"2025-10-07T12:45:16.238Z","level":"INFO","category":"DATABASE","message":"Redis connection closed","file":"main.go","line":208}
{"timestamp":"2025-10-07T12:45:16.238Z","level":"INFO","category":"DATABASE","message":"PostgreSQL connection closed","file":"main.go","line":204}
{"timestamp":"2025-10-07T12:45:16.238Z","level":"INFO","category":"LOGGER","message":"Closing log file","file":"logger.go","line":216}
{"timestamp":"2025-10-07T12:45:18.231Z","level":"INFO","category":"LOGGER","message":"Enhanced logging system initialized","file":"logger.go","line":68}
{"timestamp":"2025-10-07T12:45:18.231Z","level":"INFO","category":"LOGGER","message":"Log file: logs/order-gateway-2025-10-07.log","file":"logger.go","line":69}
{"timestamp":"2025-10-07T12:45:18.231Z","level":"INFO","category":"APP","message":"Starting Order Service initialization","file":"main.go","line":185}
{"timestamp":"2025-10-07T12:45:18.235Z","level":"INFO","category":"CONFIG","message":"Loaded environment variables from .env file","file":"main.go","line":191}
{"timestamp":"2025-10-07T12:45:18.235Z","level":"INFO","category":"APP","message":"Verifying database connections","file":"main.go","line":199}
{"timestamp":"2025-10-07T12:45:18.235Z","level":"INFO","category":"DATABASE","message":"Attempting to connect to PostgreSQL (attempt 1/5)","file":"main.go","line":121}
{"timestamp":"2025-10-07T12:45:18.247Z","level":"INFO","category":"DATABASE","message":"âœ… PostgreSQL connection successful","file":"main.go","line":145}
{"timestamp":"2025-10-07T12:45:18.248Z","level":"INFO","category":"REDIS","message":"Keyspace notifications enabled for expired events","file":"main.go","line":166}
{"timestamp":"2025-10-07T12:45:18.248Z","level":"INFO","category":"DATABASE","message":"âœ… Redis connection successful to localhost:6379 (DB: 0)","file":"main.go","line":168}
{"timestamp":"2025-10-07T12:45:18.248Z","level":"INFO","category":"KAFKA","message":"Initializing Kafka producer","file":"main.go","line":211}
{"timestamp":"2025-10-07T12:45:18.248Z","level":"INFO","category":"KAFKA","message":"Using Kafka address from environment variable: localhost:9092","file":"main.go","line":214}
{"timestamp":"2025-10-07T12:45:18.249Z","level":"INFO","category":"KAFKA","message":"Kafka brokers configured: [localhost:9092]","file":"main.go","line":216}
{"timestamp":"2025-10-07T12:45:18.249Z","level":"INFO","category":"KAFKA","message":"Kafka producer initialized successfully","file":"main.go","line":218}
{"timestamp":"2025-10-07T12:45:18.249Z","level":"INFO","category":"KAFKA","message":"Ensuring required topics exist","file":"main.go","line":221}
{"timestamp":"2025-10-07T12:45:19.262Z","level":"INFO","category":"KAFKA","message":"Required topics ensured successfully","file":"main.go","line":234}
{"timestamp":"2025-10-07T12:45:19.262Z","level":"INFO","category":"SERVICE","message":"Initializing ticket service","file":"main.go","line":237}
{"timestamp":"2025-10-07T12:45:19.262Z","level":"INFO","category":"SERVICE","message":"Initializing order service","file":"main.go","line":240}
{"timestamp":"2025-10-07T12:45:19.262Z","level":"INFO","category":"LOGGER","message":"Enhanced logging system initialized","file":"logger.go","line":68}
{"timestamp":"2025-10-07T12:45:19.262Z","level":"INFO","category":"LOGGER","message":"Log file: logs/order-gateway-2025-10-07.log","file":"logger.go","line":69}
{"timestamp":"2025-10-07T12:45:19.262Z","level":"INFO","category":"LOGGER","message":"Enhanced logging system initialized","file":"logger.go","line":68}
{"timestamp":"2025-10-07T12:45:19.262Z","level":"INFO","category":"LOGGER","message":"Log file: logs/order-gateway-2025-10-07.log","file":"logger.go","line":69}
{"timestamp":"2025-10-07T12:45:19.262Z","level":"INFO","category":"HTTP","message":"Setting up router and middleware","file":"main.go","line":259}
{"timestamp":"2025-10-07T12:45:19.279Z","level":"INFO","category":"AUTH","message":"JWT middleware applied globally","file":"main.go","line":265}
{"timestamp":"2025-10-07T12:45:19.279Z","level":"INFO","category":"ROUTER","message":"Order routes registered under /api/order","file":"main.go","line":279}
{"timestamp":"2025-10-07T12:45:19.279Z","level":"INFO","category":"ROUTER","message":"Ticket routes registered under /api/order/ticket","file":"main.go","line":289}
{"timestamp":"2025-10-07T12:45:19.279Z","level":"INFO","category":"REDIS","message":"Starting seat unlock subscription","file":"main.go","line":299}
{"timestamp":"2025-10-07T12:45:19.279Z","level":"INFO","category":"REDIS","message":"Current keyspace notifications setting: [notify-keyspace-events xE]","file":"main.go","line":48}
{"timestamp":"2025-10-07T12:45:19.281Z","level":"INFO","category":"REDIS","message":"Subscribed to Redis keyevent expired notifications (DB 0)","file":"main.go","line":55}
{"timestamp":"2025-10-07T12:45:19.281Z","level":"INFO","category":"HTTP","message":"ðŸš€ Order Service running on :8084","file":"main.go","line":304}
{"timestamp":"2025-10-07T12:45:19.281Z","level":"INFO","category":"APP","message":"Service started successfully, waiting for shutdown signal","file":"main.go","line":313}
{"timestamp":"2025-10-07T12:45:30.682Z","level":"INFO","category":"API","message":"SeatValidationAndPlaceOrder: received request","file":"handler.go","line":254}
{"timestamp":"2025-10-07T12:45:30.682Z","level":"DEBUG","category":"API","message":"SeatValidationAndPlaceOrder: SessionID: 0e16aca6-92dd-4847-b952-31552963c335","file":"handler.go","line":265}
{"timestamp":"2025-10-07T12:45:30.682Z","level":"DEBUG","category":"API","message":"SeatValidationAndPlaceOrder: SeatIDs: [7ae30663-5239-4177-823d-a415de05edea bc2764c0-9247-40ef-9343-23ca6cdb325f]","file":"handler.go","line":266}
{"timestamp":"2025-10-07T12:45:30.682Z","level":"INFO","category":"ORDER","message":"Starting seat validation and order placement process","file":"service.go","line":214}
{"timestamp":"2025-10-07T12:45:30.682Z","level":"DEBUG","category":"ORDER","message":"Order request: {SessionID:0e16aca6-92dd-4847-b952-31552963c335 EventID:79955f7b-3735-4dce-a112-ba0ef29d36bd SeatIDs:[7ae30663-5239-4177-823d-a415de05edea bc2764c0-9247-40ef-9343-23ca6cdb325f] DiscountID:}","file":"service.go","line":229}
{"timestamp":"2025-10-07T12:45:30.682Z","level":"DEBUG","category":"AUTH","message":"Requesting M2M token for seat validation","file":"service.go","line":237}
{"timestamp":"2025-10-07T12:45:30.691Z","level":"DEBUG","category":"ORDER","message":"Generated order ID: d03bd6bf-ed91-4493-baf3-4a8f96f30eb6","file":"service.go","line":246}
{"timestamp":"2025-10-07T12:45:30.691Z","level":"DEBUG","category":"PRE_VALIDATION","message":"Making first HTTP request to validate pre-order","file":"service.go","line":249}
{"timestamp":"2025-10-07T12:45:30.691Z","level":"DEBUG","category":"PRE_VALIDATION","message":"Pre-validation URL: http://localhost:8082/api/event-query/internal/v1/validate-pre-order","file":"service.go","line":264}
{"timestamp":"2025-10-07T12:45:30.691Z","level":"DEBUG","category":"PRE_VALIDATION","message":"Request body: {\"session_id\":\"0e16aca6-92dd-4847-b952-31552963c335\",\"event_id\":\"79955f7b-3735-4dce-a112-ba0ef29d36bd\",\"seat_ids\":[\"7ae30663-5239-4177-823d-a415de05edea\",\"bc2764c0-9247-40ef-9343-23ca6cdb325f\"],\"discount_id\":\"\"}","file":"service.go","line":265}
{"timestamp":"2025-10-07T12:45:30.799Z","level":"INFO","category":"PRE_VALIDATION","message":"Pre-validation successful, OrderDetailsDTO received","file":"service.go","line":295}
{"timestamp":"2025-10-07T12:45:30.799Z","level":"DEBUG","category":"REDIS","message":"Attempting to lock seats in Redis","file":"service.go","line":298}
{"timestamp":"2025-10-07T12:45:33.813Z","level":"INFO","category":"REDIS","message":"Seats locked successfully","file":"service.go","line":308}
{"timestamp":"2025-10-07T12:45:33.813Z","level":"DEBUG","category":"SEAT_VALIDATION","message":"Making second HTTP request to validate seats after locking","file":"service.go","line":317}
{"timestamp":"2025-10-07T12:45:33.898Z","level":"INFO","category":"SEAT_VALIDATION","message":"Final seat validation successful","file":"service.go","line":353}
{"timestamp":"2025-10-07T12:45:34.906Z","level":"INFO","category":"KAFKA","message":"Published seats locked event for 2 seats","file":"service.go","line":540}
{"timestamp":"2025-10-07T12:45:34.906Z","level":"DEBUG","category":"DISCOUNT","message":"No discount applied to order","file":"service.go","line":407}
{"timestamp":"2025-10-07T12:45:34.906Z","level":"INFO","category":"ORDER","message":"Placing order: d03bd6bf-ed91-4493-baf3-4a8f96f30eb6 for session: 0e16aca6-92dd-4847-b952-31552963c335","file":"service.go","line":72}
{"timestamp":"2025-10-07T12:45:34.906Z","level":"DEBUG","category":"ORDER","message":"Skipping seat locking as seats are already locked","file":"service.go","line":87}
{"timestamp":"2025-10-07T12:45:34.906Z","level":"DEBUG","category":"ORDER","message":"Creating order in DB...","file":"service.go","line":90}
{"timestamp":"2025-10-07T12:45:34.910Z","level":"INFO","category":"KAFKA","message":"Order created successfully, publishing to Kafka...","file":"service.go","line":98}
{"timestamp":"2025-10-07T12:45:35.923Z","level":"INFO","category":"KAFKA","message":"Published order created event for order: d03bd6bf-ed91-4493-baf3-4a8f96f30eb6","file":"service.go","line":492}
{"timestamp":"2025-10-07T12:45:35.923Z","level":"INFO","category":"ORDER","message":"Order d03bd6bf-ed91-4493-baf3-4a8f96f30eb6 placed successfully","file":"service.go","line":103}
{"timestamp":"2025-10-07T12:45:35.923Z","level":"INFO","category":"TICKET","message":"Creating tickets for each seat","file":"service.go","line":439}
{"timestamp":"2025-10-07T12:45:35.935Z","level":"INFO","category":"TICKET","message":"Created ticket c3db1583-a215-41c9-939f-3f31a24650f6 for seat bc2764c0-9247-40ef-9343-23ca6cdb325f","file":"service.go","line":461}
{"timestamp":"2025-10-07T12:45:35.943Z","level":"INFO","category":"TICKET","message":"Created ticket f6ce7497-6e22-4356-9233-319933fe06b2 for seat 7ae30663-5239-4177-823d-a415de05edea","file":"service.go","line":461}
{"timestamp":"2025-10-07T12:45:35.944Z","level":"INFO","category":"ORDER","message":"Order d03bd6bf-ed91-4493-baf3-4a8f96f30eb6 completed successfully for user e267b380-da95-4638-9f33-3d9bc4807e1a","file":"service.go","line":471}
{"timestamp":"2025-10-07T12:45:35.944Z","level":"INFO","category":"API","message":"SeatValidationAndPlaceOrder: order created successfully","file":"handler.go","line":280}
{"timestamp":"2025-10-07T12:46:29.132Z","level":"INFO","category":"API","message":"SeatValidationAndPlaceOrder: received request","file":"handler.go","line":254}
{"timestamp":"2025-10-07T12:46:29.132Z","level":"DEBUG","category":"API","message":"SeatValidationAndPlaceOrder: SessionID: 0e16aca6-92dd-4847-b952-31552963c335","file":"handler.go","line":265}
{"timestamp":"2025-10-07T12:46:29.132Z","level":"DEBUG","category":"API","message":"SeatValidationAndPlaceOrder: SeatIDs: [3f934b7c-f67d-42a6-8305-585b541245ce 5a473b75-4057-46e7-99e4-a7998910d2a6 6d81b445-1f68-4b9b-8d00-7f3ec11a28fe]","file":"handler.go","line":266}
{"timestamp":"2025-10-07T12:46:29.132Z","level":"INFO","category":"ORDER","message":"Starting seat validation and order placement process","file":"service.go","line":214}
{"timestamp":"2025-10-07T12:46:29.133Z","level":"DEBUG","category":"ORDER","message":"Order request: {SessionID:0e16aca6-92dd-4847-b952-31552963c335 EventID:79955f7b-3735-4dce-a112-ba0ef29d36bd SeatIDs:[3f934b7c-f67d-42a6-8305-585b541245ce 5a473b75-4057-46e7-99e4-a7998910d2a6 6d81b445-1f68-4b9b-8d00-7f3ec11a28fe] DiscountID:6e52d131-9994-49d2-86e2-99b16c2178d4}","file":"service.go","line":229}
{"timestamp":"2025-10-07T12:46:29.133Z","level":"DEBUG","category":"AUTH","message":"Requesting M2M token for seat validation","file":"service.go","line":237}
{"timestamp":"2025-10-07T12:46:29.139Z","level":"DEBUG","category":"ORDER","message":"Generated order ID: 407dd706-b2a3-405b-9615-df33ebfdc9e2","file":"service.go","line":246}
{"timestamp":"2025-10-07T12:46:29.139Z","level":"DEBUG","category":"PRE_VALIDATION","message":"Making first HTTP request to validate pre-order","file":"service.go","line":249}
{"timestamp":"2025-10-07T12:46:29.139Z","level":"DEBUG","category":"PRE_VALIDATION","message":"Pre-validation URL: http://localhost:8082/api/event-query/internal/v1/validate-pre-order","file":"service.go","line":264}
{"timestamp":"2025-10-07T12:46:29.139Z","level":"DEBUG","category":"PRE_VALIDATION","message":"Request body: {\"session_id\":\"0e16aca6-92dd-4847-b952-31552963c335\",\"event_id\":\"79955f7b-3735-4dce-a112-ba0ef29d36bd\",\"seat_ids\":[\"3f934b7c-f67d-42a6-8305-585b541245ce\",\"5a473b75-4057-46e7-99e4-a7998910d2a6\",\"6d81b445-1f68-4b9b-8d00-7f3ec11a28fe\"],\"discount_id\":\"6e52d131-9994-49d2-86e2-99b16c2178d4\"}","file":"service.go","line":265}
{"timestamp":"2025-10-07T12:46:29.163Z","level":"INFO","category":"PRE_VALIDATION","message":"Pre-validation successful, OrderDetailsDTO received","file":"service.go","line":295}
{"timestamp":"2025-10-07T12:46:29.163Z","level":"DEBUG","category":"REDIS","message":"Attempting to lock seats in Redis","file":"service.go","line":298}
{"timestamp":"2025-10-07T12:46:30.885Z","level":"INFO","category":"REDIS","message":"Received expired key event: seat_lock:7ae30663-5239-4177-823d-a415de05edea","file":"main.go","line":59}
{"timestamp":"2025-10-07T12:46:30.885Z","level":"INFO","category":"SEAT_UNLOCK","message":"Seat lock expired for seat: 7ae30663-5239-4177-823d-a415de05edea","file":"main.go","line":62}
{"timestamp":"2025-10-07T12:46:30.888Z","level":"ERROR","category":"SEAT_UNLOCK","message":"Failed to get session ID for seat 7ae30663-5239-4177-823d-a415de05edea: pq: operator does not exist: text[] ~~ unknown","file":"main.go","line":67}
{"timestamp":"2025-10-07T12:46:32.170Z","level":"INFO","category":"REDIS","message":"Seats locked successfully","file":"service.go","line":308}
{"timestamp":"2025-10-07T12:46:32.170Z","level":"DEBUG","category":"SEAT_VALIDATION","message":"Making second HTTP request to validate seats after locking","file":"service.go","line":317}
{"timestamp":"2025-10-07T12:46:32.533Z","level":"INFO","category":"SEAT_VALIDATION","message":"Final seat validation successful","file":"service.go","line":353}
{"timestamp":"2025-10-07T12:46:32.894Z","level":"INFO","category":"REDIS","message":"Received expired key event: seat_lock:bc2764c0-9247-40ef-9343-23ca6cdb325f","file":"main.go","line":59}
{"timestamp":"2025-10-07T12:46:32.894Z","level":"INFO","category":"SEAT_UNLOCK","message":"Seat lock expired for seat: bc2764c0-9247-40ef-9343-23ca6cdb325f","file":"main.go","line":62}
{"timestamp":"2025-10-07T12:46:32.895Z","level":"ERROR","category":"SEAT_UNLOCK","message":"Failed to get session ID for seat bc2764c0-9247-40ef-9343-23ca6cdb325f: pq: operator does not exist: text[] ~~ unknown","file":"main.go","line":67}
{"timestamp":"2025-10-07T12:46:33.536Z","level":"INFO","category":"KAFKA","message":"Published seats locked event for 3 seats","file":"service.go","line":540}
{"timestamp":"2025-10-07T12:46:33.536Z","level":"DEBUG","category":"DISCOUNT","message":"Processing discount from OrderDetailsDTO: SAVE10","file":"service.go","line":374}
{"timestamp":"2025-10-07T12:46:33.536Z","level":"INFO","category":"DISCOUNT","message":"Applied discount: 270.00, final price: 2430.00","file":"service.go","line":405}
{"timestamp":"2025-10-07T12:46:33.536Z","level":"INFO","category":"ORDER","message":"Placing order: 407dd706-b2a3-405b-9615-df33ebfdc9e2 for session: 0e16aca6-92dd-4847-b952-31552963c335","file":"service.go","line":72}
{"timestamp":"2025-10-07T12:46:33.536Z","level":"DEBUG","category":"ORDER","message":"Skipping seat locking as seats are already locked","file":"service.go","line":87}
{"timestamp":"2025-10-07T12:46:33.536Z","level":"DEBUG","category":"ORDER","message":"Creating order in DB...","file":"service.go","line":90}
{"timestamp":"2025-10-07T12:46:33.538Z","level":"INFO","category":"KAFKA","message":"Order created successfully, publishing to Kafka...","file":"service.go","line":98}
{"timestamp":"2025-10-07T12:46:34.540Z","level":"INFO","category":"KAFKA","message":"Published order created event for order: 407dd706-b2a3-405b-9615-df33ebfdc9e2","file":"service.go","line":492}
{"timestamp":"2025-10-07T12:46:34.540Z","level":"INFO","category":"ORDER","message":"Order 407dd706-b2a3-405b-9615-df33ebfdc9e2 placed successfully","file":"service.go","line":103}
{"timestamp":"2025-10-07T12:46:34.540Z","level":"INFO","category":"TICKET","message":"Creating tickets for each seat","file":"service.go","line":439}
{"timestamp":"2025-10-07T12:46:34.549Z","level":"INFO","category":"TICKET","message":"Created ticket 21a9fc39-e5f0-4ac0-8f26-6398d2f7b07c for seat 6d81b445-1f68-4b9b-8d00-7f3ec11a28fe","file":"service.go","line":461}
{"timestamp":"2025-10-07T12:46:34.560Z","level":"INFO","category":"TICKET","message":"Created ticket ade4bea8-6f6b-48b7-a8c1-06135b7bb094 for seat 5a473b75-4057-46e7-99e4-a7998910d2a6","file":"service.go","line":461}
{"timestamp":"2025-10-07T12:46:34.568Z","level":"INFO","category":"TICKET","message":"Created ticket a964c23e-9b0c-4282-838e-bdf08879bb82 for seat 3f934b7c-f67d-42a6-8305-585b541245ce","file":"service.go","line":461}
{"timestamp":"2025-10-07T12:46:34.569Z","level":"INFO","category":"ORDER","message":"Order 407dd706-b2a3-405b-9615-df33ebfdc9e2 completed successfully for user e267b380-da95-4638-9f33-3d9bc4807e1a","file":"service.go","line":471}
{"timestamp":"2025-10-07T12:46:34.569Z","level":"INFO","category":"API","message":"SeatValidationAndPlaceOrder: order created successfully","file":"handler.go","line":280}
{"timestamp":"2025-10-07T12:47:29.256Z","level":"INFO","category":"REDIS","message":"Received expired key event: seat_lock:3f934b7c-f67d-42a6-8305-585b541245ce","file":"main.go","line":59}
{"timestamp":"2025-10-07T12:47:29.257Z","level":"INFO","category":"SEAT_UNLOCK","message":"Seat lock expired for seat: 3f934b7c-f67d-42a6-8305-585b541245ce","file":"main.go","line":62}
{"timestamp":"2025-10-07T12:47:29.259Z","level":"ERROR","category":"SEAT_UNLOCK","message":"Failed to get session ID for seat 3f934b7c-f67d-42a6-8305-585b541245ce: pq: operator does not exist: text[] ~~ unknown","file":"main.go","line":67}
{"timestamp":"2025-10-07T12:47:30.363Z","level":"INFO","category":"REDIS","message":"Received expired key event: seat_lock:5a473b75-4057-46e7-99e4-a7998910d2a6","file":"main.go","line":59}
{"timestamp":"2025-10-07T12:47:30.363Z","level":"INFO","category":"SEAT_UNLOCK","message":"Seat lock expired for seat: 5a473b75-4057-46e7-99e4-a7998910d2a6","file":"main.go","line":62}
{"timestamp":"2025-10-07T12:47:30.363Z","level":"ERROR","category":"SEAT_UNLOCK","message":"Failed to get session ID for seat 5a473b75-4057-46e7-99e4-a7998910d2a6: pq: operator does not exist: text[] ~~ unknown","file":"main.go","line":67}
{"timestamp":"2025-10-07T12:47:31.266Z","level":"INFO","category":"REDIS","message":"Received expired key event: seat_lock:6d81b445-1f68-4b9b-8d00-7f3ec11a28fe","file":"main.go","line":59}
{"timestamp":"2025-10-07T12:47:31.267Z","level":"INFO","category":"SEAT_UNLOCK","message":"Seat lock expired for seat: 6d81b445-1f68-4b9b-8d00-7f3ec11a28fe","file":"main.go","line":62}
{"timestamp":"2025-10-07T12:47:31.267Z","level":"ERROR","category":"SEAT_UNLOCK","message":"Failed to get session ID for seat 6d81b445-1f68-4b9b-8d00-7f3ec11a28fe: pq: operator does not exist: text[] ~~ unknown","file":"main.go","line":67}
{"timestamp":"2025-10-07T12:53:56.849Z","level":"INFO","category":"APP","message":"Shutdown signal received, initiating graceful shutdown","file":"main.go","line":316}
{"timestamp":"2025-10-07T12:53:56.853Z","level":"INFO","category":"HTTP","message":"âœ… Order Service shutdown complete","file":"main.go","line":323}
{"timestamp":"2025-10-07T12:53:56.853Z","level":"INFO","category":"DATABASE","message":"Redis connection closed","file":"main.go","line":208}
{"timestamp":"2025-10-07T12:53:56.853Z","level":"INFO","category":"DATABASE","message":"PostgreSQL connection closed","file":"main.go","line":204}
{"timestamp":"2025-10-07T12:53:56.853Z","level":"INFO","category":"LOGGER","message":"Closing log file","file":"logger.go","line":216}
{"timestamp":"2025-10-07T12:53:58.462Z","level":"INFO","category":"LOGGER","message":"Enhanced logging system initialized","file":"logger.go","line":68}
{"timestamp":"2025-10-07T12:53:58.463Z","level":"INFO","category":"LOGGER","message":"Log file: logs/order-gateway-2025-10-07.log","file":"logger.go","line":69}
{"timestamp":"2025-10-07T12:53:58.463Z","level":"INFO","category":"APP","message":"Starting Order Service initialization","file":"main.go","line":185}
{"timestamp":"2025-10-07T12:53:58.466Z","level":"INFO","category":"CONFIG","message":"Loaded environment variables from .env file","file":"main.go","line":191}
{"timestamp":"2025-10-07T12:53:58.466Z","level":"INFO","category":"APP","message":"Verifying database connections","file":"main.go","line":199}
{"timestamp":"2025-10-07T12:53:58.466Z","level":"INFO","category":"DATABASE","message":"Attempting to connect to PostgreSQL (attempt 1/5)","file":"main.go","line":121}
{"timestamp":"2025-10-07T12:53:58.473Z","level":"INFO","category":"DATABASE","message":"âœ… PostgreSQL connection successful","file":"main.go","line":145}
{"timestamp":"2025-10-07T12:53:58.475Z","level":"INFO","category":"REDIS","message":"Keyspace notifications enabled for expired events","file":"main.go","line":166}
{"timestamp":"2025-10-07T12:53:58.475Z","level":"INFO","category":"DATABASE","message":"âœ… Redis connection successful to localhost:6379 (DB: 0)","file":"main.go","line":168}
{"timestamp":"2025-10-07T12:53:58.475Z","level":"INFO","category":"KAFKA","message":"Initializing Kafka producer","file":"main.go","line":211}
{"timestamp":"2025-10-07T12:53:58.475Z","level":"INFO","category":"KAFKA","message":"Using Kafka address from environment variable: localhost:9092","file":"main.go","line":214}
{"timestamp":"2025-10-07T12:53:58.475Z","level":"INFO","category":"KAFKA","message":"Kafka brokers configured: [localhost:9092]","file":"main.go","line":216}
{"timestamp":"2025-10-07T12:53:58.475Z","level":"INFO","category":"KAFKA","message":"Kafka producer initialized successfully","file":"main.go","line":218}
{"timestamp":"2025-10-07T12:53:58.475Z","level":"INFO","category":"KAFKA","message":"Ensuring required topics exist","file":"main.go","line":221}
{"timestamp":"2025-10-07T12:53:59.494Z","level":"INFO","category":"KAFKA","message":"Required topics ensured successfully","file":"main.go","line":234}
{"timestamp":"2025-10-07T12:53:59.494Z","level":"INFO","category":"SERVICE","message":"Initializing ticket service","file":"main.go","line":237}
{"timestamp":"2025-10-07T12:53:59.494Z","level":"INFO","category":"SERVICE","message":"Initializing order service","file":"main.go","line":240}
{"timestamp":"2025-10-07T12:53:59.494Z","level":"INFO","category":"LOGGER","message":"Enhanced logging system initialized","file":"logger.go","line":68}
{"timestamp":"2025-10-07T12:53:59.494Z","level":"INFO","category":"LOGGER","message":"Log file: logs/order-gateway-2025-10-07.log","file":"logger.go","line":69}
{"timestamp":"2025-10-07T12:53:59.494Z","level":"INFO","category":"LOGGER","message":"Enhanced logging system initialized","file":"logger.go","line":68}
{"timestamp":"2025-10-07T12:53:59.494Z","level":"INFO","category":"LOGGER","message":"Log file: logs/order-gateway-2025-10-07.log","file":"logger.go","line":69}
{"timestamp":"2025-10-07T12:53:59.494Z","level":"INFO","category":"HTTP","message":"Setting up router and middleware","file":"main.go","line":259}
{"timestamp":"2025-10-07T12:53:59.546Z","level":"INFO","category":"AUTH","message":"JWT middleware applied globally","file":"main.go","line":265}
{"timestamp":"2025-10-07T12:53:59.546Z","level":"INFO","category":"ROUTER","message":"Order routes registered under /api/order","file":"main.go","line":279}
{"timestamp":"2025-10-07T12:53:59.546Z","level":"INFO","category":"ROUTER","message":"Ticket routes registered under /api/order/ticket","file":"main.go","line":289}
{"timestamp":"2025-10-07T12:53:59.546Z","level":"INFO","category":"REDIS","message":"Starting seat unlock subscription","file":"main.go","line":299}
{"timestamp":"2025-10-07T12:53:59.546Z","level":"INFO","category":"REDIS","message":"Current keyspace notifications setting: [notify-keyspace-events xE]","file":"main.go","line":48}
{"timestamp":"2025-10-07T12:53:59.547Z","level":"INFO","category":"REDIS","message":"Subscribed to Redis keyevent expired notifications (DB 0)","file":"main.go","line":55}
{"timestamp":"2025-10-07T12:53:59.547Z","level":"INFO","category":"HTTP","message":"ðŸš€ Order Service running on :8084","file":"main.go","line":304}
{"timestamp":"2025-10-07T12:53:59.547Z","level":"INFO","category":"APP","message":"Service started successfully, waiting for shutdown signal","file":"main.go","line":313}
{"timestamp":"2025-10-07T12:54:28.399Z","level":"INFO","category":"API","message":"SeatValidationAndPlaceOrder: received request","file":"handler.go","line":254}
{"timestamp":"2025-10-07T12:54:28.400Z","level":"DEBUG","category":"API","message":"SeatValidationAndPlaceOrder: SessionID: 0e16aca6-92dd-4847-b952-31552963c335","file":"handler.go","line":265}
{"timestamp":"2025-10-07T12:54:28.400Z","level":"DEBUG","category":"API","message":"SeatValidationAndPlaceOrder: SeatIDs: [9422e0db-3151-4a1a-ac06-fe52ba83fbae]","file":"handler.go","line":266}
{"timestamp":"2025-10-07T12:54:28.400Z","level":"INFO","category":"ORDER","message":"Starting seat validation and order placement process","file":"service.go","line":214}
{"timestamp":"2025-10-07T12:54:28.400Z","level":"DEBUG","category":"ORDER","message":"Order request: {SessionID:0e16aca6-92dd-4847-b952-31552963c335 EventID:79955f7b-3735-4dce-a112-ba0ef29d36bd SeatIDs:[9422e0db-3151-4a1a-ac06-fe52ba83fbae] DiscountID:}","file":"service.go","line":229}
{"timestamp":"2025-10-07T12:54:28.400Z","level":"DEBUG","category":"AUTH","message":"Requesting M2M token for seat validation","file":"service.go","line":237}
{"timestamp":"2025-10-07T12:54:28.407Z","level":"DEBUG","category":"ORDER","message":"Generated order ID: 2ef87201-a92f-4510-aa1a-4f9288d664d0","file":"service.go","line":246}
{"timestamp":"2025-10-07T12:54:28.407Z","level":"DEBUG","category":"PRE_VALIDATION","message":"Making first HTTP request to validate pre-order","file":"service.go","line":249}
{"timestamp":"2025-10-07T12:54:28.407Z","level":"DEBUG","category":"PRE_VALIDATION","message":"Pre-validation URL: http://localhost:8082/api/event-query/internal/v1/validate-pre-order","file":"service.go","line":264}
{"timestamp":"2025-10-07T12:54:28.407Z","level":"DEBUG","category":"PRE_VALIDATION","message":"Request body: {\"session_id\":\"0e16aca6-92dd-4847-b952-31552963c335\",\"event_id\":\"79955f7b-3735-4dce-a112-ba0ef29d36bd\",\"seat_ids\":[\"9422e0db-3151-4a1a-ac06-fe52ba83fbae\"],\"discount_id\":\"\"}","file":"service.go","line":265}
{"timestamp":"2025-10-07T12:54:28.452Z","level":"INFO","category":"PRE_VALIDATION","message":"Pre-validation successful, OrderDetailsDTO received","file":"service.go","line":295}
{"timestamp":"2025-10-07T12:54:28.452Z","level":"DEBUG","category":"REDIS","message":"Attempting to lock seats in Redis","file":"service.go","line":298}
{"timestamp":"2025-10-07T12:54:30.469Z","level":"INFO","category":"REDIS","message":"Seats locked successfully","file":"service.go","line":308}
{"timestamp":"2025-10-07T12:54:30.469Z","level":"DEBUG","category":"SEAT_VALIDATION","message":"Making second HTTP request to validate seats after locking","file":"service.go","line":317}
{"timestamp":"2025-10-07T12:54:30.571Z","level":"INFO","category":"SEAT_VALIDATION","message":"Final seat validation successful","file":"service.go","line":353}
{"timestamp":"2025-10-07T12:54:31.577Z","level":"INFO","category":"KAFKA","message":"Published seats locked event for 1 seats","file":"service.go","line":540}
{"timestamp":"2025-10-07T12:54:31.577Z","level":"DEBUG","category":"DISCOUNT","message":"No discount applied to order","file":"service.go","line":407}
{"timestamp":"2025-10-07T12:54:31.577Z","level":"INFO","category":"ORDER","message":"Placing order: 2ef87201-a92f-4510-aa1a-4f9288d664d0 for session: 0e16aca6-92dd-4847-b952-31552963c335","file":"service.go","line":72}
{"timestamp":"2025-10-07T12:54:31.577Z","level":"DEBUG","category":"ORDER","message":"Skipping seat locking as seats are already locked","file":"service.go","line":87}
{"timestamp":"2025-10-07T12:54:31.577Z","level":"DEBUG","category":"ORDER","message":"Creating order in DB...","file":"service.go","line":90}
{"timestamp":"2025-10-07T12:54:31.581Z","level":"INFO","category":"KAFKA","message":"Order created successfully, publishing to Kafka...","file":"service.go","line":98}
{"timestamp":"2025-10-07T12:54:32.587Z","level":"INFO","category":"KAFKA","message":"Published order created event for order: 2ef87201-a92f-4510-aa1a-4f9288d664d0","file":"service.go","line":492}
{"timestamp":"2025-10-07T12:54:32.587Z","level":"INFO","category":"ORDER","message":"Order 2ef87201-a92f-4510-aa1a-4f9288d664d0 placed successfully","file":"service.go","line":103}
{"timestamp":"2025-10-07T12:54:32.587Z","level":"INFO","category":"TICKET","message":"Creating tickets for each seat","file":"service.go","line":439}
{"timestamp":"2025-10-07T12:54:32.597Z","level":"INFO","category":"TICKET","message":"Created ticket 43c1d3b3-a595-4824-afa3-94e70ba0082d for seat 9422e0db-3151-4a1a-ac06-fe52ba83fbae","file":"service.go","line":461}
{"timestamp":"2025-10-07T12:54:32.597Z","level":"INFO","category":"ORDER","message":"Order 2ef87201-a92f-4510-aa1a-4f9288d664d0 completed successfully for user e267b380-da95-4638-9f33-3d9bc4807e1a","file":"service.go","line":471}
{"timestamp":"2025-10-07T12:54:32.597Z","level":"INFO","category":"API","message":"SeatValidationAndPlaceOrder: order created successfully","file":"handler.go","line":280}
